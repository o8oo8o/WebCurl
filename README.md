# ğŸš€ WebCurl - æç®€ç½‘é¡µç‰ˆAPIè°ƒè¯•åŠMockç¥å™¨

> **âš¡ ä¸€ä¸ªæ–‡ä»¶æå®šæ‰€æœ‰APIè¯·æ±‚å’ŒMockæœåŠ¡éœ€æ±‚ | ğŸ¯ æ›¿ä»£Postmançš„è½»é‡çº§é€‰æ‹© | ğŸ”’ æ•°æ®æœ¬åœ°åŒ–ï¼Œå®‰å…¨æ— å¿§**

[![Go Version](https://img.shields.io/badge/Go-1.19+-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/Platform-Windows%20%7C%20Linux%20%7C%20MacOS%20%7C%20ARM-lightgrey.svg)]()

> **è”ç³»æˆ‘: QQ 774309635**

## âœ¨ ä¸ºä»€ä¹ˆé€‰æ‹© WebCurlï¼Ÿ

è¿˜åœ¨ä¸ºAPIè°ƒè¯•å·¥å…·è€Œçƒ¦æ¼å—ï¼ŸPostmanå¤ªè‡ƒè‚¿ï¼Ÿcurlå‘½ä»¤è¡Œå¤ªå¤æ‚ï¼Ÿè¯•è¯• **WebCurl** å§ï¼

ğŸ‰ **ä¸€ä¸ª8MBçš„äºŒè¿›åˆ¶æ–‡ä»¶ = å®Œæ•´çš„APIæµ‹è¯•å’ŒMockè§£å†³æ–¹æ¡ˆ**

ğŸ’¡ **æºç æç®€**ï¼šä»…å‡ ä¸ªæ–‡ä»¶å®ç°å®Œæ•´åŠŸèƒ½

### ğŸŒŸ æ ¸å¿ƒä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | WebCurl | Postman | curl |
|------|---------|---------|------|
| **å®‰è£…å¤æ‚åº¦** | â­ ä¸€ä¸ªæ–‡ä»¶ | â­â­â­ éœ€è¦å®‰è£… | â­â­ å‘½ä»¤è¡Œ |
| **è·¨åŸŸæ”¯æŒ** | âœ… å®Œç¾è§£å†³ | âœ… åŸç”Ÿæ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ |
| **æ–‡ä»¶å¤§å°** | 8MB        | 200MB+      | ç³»ç»Ÿè‡ªå¸¦ |
| **ç¦»çº¿ä½¿ç”¨** | âœ… å®Œå…¨ç¦»çº¿ | âŒ éœ€è¦ç™»å½• | âœ… å®Œå…¨ç¦»çº¿ |
| **æ•°æ®å®‰å…¨** | âœ… æœ¬åœ°å­˜å‚¨ | âŒ äº‘ç«¯åŒæ­¥ | âœ… æœ¬åœ°å­˜å‚¨ |
| **ä¿¡åˆ›å…¼å®¹** | âœ… å®Œç¾æ”¯æŒ | âŒ æœ‰é™æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **IPv6æ”¯æŒ** | âœ… å®Œç¾æ”¯æŒ | âœ… æ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ |
| **æºç ç®€æ´** | âœ… ä»…4ä¸ªæ–‡ä»¶ | âŒ å¤æ‚é¡¹ç›® | âŒ å¤æ‚é¡¹ç›® |
| **å®æ—¶é€šä¿¡** | âœ… WebSocket+SSE | âŒ ä»…HTTP | âŒ ä»…HTTP |
| **è°ƒè¯•æ¥å£** | âœ… å†…ç½®EchoServer | âŒ éœ€é¢å¤–å·¥å…· | âŒ éœ€é¢å¤–å·¥å…· |
| **MockæœåŠ¡** | âœ… æ”¯æŒè‡ªå®šä¹‰ | âŒ éœ€é¢å¤–å·¥å…· | âŒ éœ€é¢å¤–å·¥å…· |

## ğŸ“– ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªæè‡´è½»é‡ã€è·¨å¹³å°ã€æ— ä¾èµ–çš„ HTTP è¯·æ±‚è½¬å‘ä¸è°ƒè¯•å·¥å…·ï¼Œ**æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç½‘é¡µç‰ˆçš„APIæµ‹è¯•åŠMockè°ƒè¯•å·¥å…·**ï¼Œé€‚åˆæ¥å£å¼€å‘ã€è°ƒè¯•ã€æµ‹è¯•ç­‰å¤šç§åœºæ™¯ã€‚

- **å‰ç«¯**ï¼šçº¯åŸç”Ÿ HTML+JS+CSSï¼Œæ— ä»»ä½•ç¬¬ä¸‰æ–¹åº“æˆ–ä¾èµ–ï¼Œå¼€ç®±å³ç”¨ï¼ŒåŠ è½½é€Ÿåº¦æå¿«ã€‚
- **åç«¯**ï¼šä»…ä½¿ç”¨ Golang æ ‡å‡†åº“ï¼Œæ— ä»»ä½•ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå®‰å…¨å¯é ã€‚
- **æºç æç®€**ï¼šæ•´ä¸ªé¡¹ç›®ä»…åŒ…å«4ä¸ªæ–‡ä»¶ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤ã€‚
- **äº§ç‰©**ï¼šç¼–è¯‘åä»…æœ‰ä¸€ä¸ªçº¦ 8M çš„å•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå«å‰ç«¯é¡µé¢ï¼‰ï¼Œæ— éœ€å®‰è£…ã€æ— éœ€ç¯å¢ƒã€æ— éœ€ä¾èµ–ï¼Œç›´æ¥è¿è¡Œã€‚
- **å¹³å°æ”¯æŒ**ï¼šæ”¯æŒ Windowsã€Linuxã€MacOSã€ARMã€x86_64ã€ä¿¡åˆ›ï¼ˆå›½äº§èŠ¯ç‰‡/æ“ä½œç³»ç»Ÿï¼‰ç­‰ä¸»æµåŠå›½äº§å¹³å°ï¼ŒçœŸæ­£åšåˆ°"ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œ"ã€‚
- **ç½‘ç»œæ”¯æŒ**ï¼šå®Œç¾æ”¯æŒ IPv4 å’Œ IPv6 ç½‘ç»œåè®®ï¼Œé€‚åº”å„ç§ç½‘ç»œç¯å¢ƒã€‚
- **å®æ—¶é€šä¿¡**ï¼šåŸç”Ÿæ”¯æŒ WebSocket å’Œ SSEï¼ˆServer-Sent Eventsï¼‰ï¼Œæ»¡è¶³å®æ—¶æ•°æ®æ¨é€éœ€æ±‚ã€‚
- **å†…ç½®è°ƒè¯•æœåŠ¡**ï¼šé›†æˆå¼ºå¤§çš„EchoServerï¼Œæä¾›å®Œæ•´çš„è¯·æ±‚å›æ˜¾å’Œå“åº”æ§åˆ¶åŠŸèƒ½ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šæ¥å£è”è°ƒã€API æµ‹è¯•ã€å‰ç«¯è·¨åŸŸè°ƒè¯•ã€ä¿¡åˆ›ç¯å¢ƒæ¥å£æµ‹è¯•ã€ç¦»çº¿/å†…ç½‘ç¯å¢ƒæ¥å£è°ƒè¯•ç­‰ã€‚
- **æ•°æ®æœ¬åœ°åŒ–å­˜å‚¨,ä¿éšœå®‰å…¨**ï¼šæ‰€æœ‰æ¥å£ä¿¡æ¯ã€å†å²è®°å½•ã€å˜é‡ã€å…¨å±€å¤´ç­‰å‡ä»…å­˜å‚¨äºæœ¬åœ°æµè§ˆå™¨ï¼ˆlocalStorageï¼‰ï¼Œä¸ä¼šåŒæ­¥åˆ°äº‘ç«¯æˆ–å¤–éƒ¨æœåŠ¡å™¨ï¼Œä¿éšœæ¥å£æ•°æ®çš„ç§å¯†æ€§ä¸å®‰å…¨æ€§ï¼Œé€‚åˆä¼ä¸šå†…ç½‘ã€æ•æ„Ÿç¯å¢ƒä½¿ç”¨ã€‚

**ä¸»è¦ç”¨é€”**ï¼šAPI æµ‹è¯•ä¸è°ƒè¯•,æ›¿ä»£æŸäº›éœ€è¦ç™»å½•æ‰èƒ½ä½¿ç”¨å·¥å…·(xxxxMan,xxxFox)

- æ”¯æŒå¤šç§è¯·æ±‚ä½“æ ¼å¼ï¼ˆform-dataã€x-www-form-urlencodedã€jsonã€textã€xmlã€binaryï¼‰
- æ”¯æŒæ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½
- æ”¯æŒè¯·æ±‚é‡è¯•ã€è¶…æ—¶ã€SSL éªŒè¯ã€é‡å®šå‘ç­‰é«˜çº§é€‰é¡¹
- æ”¯æŒ WebSocket å’Œ SSEï¼ˆServer-Sent Eventsï¼‰å®æ—¶é€šä¿¡
- å†…ç½®ç¾è§‚æ˜“ç”¨çš„å‰ç«¯é¡µé¢ï¼Œæ”¯æŒæ¥å£å†å²ã€å˜é‡ã€å…¨å±€å¤´ã€æ¥å£é›†åˆç®¡ç†
- æ”¯æŒå‘½ä»¤è¡Œå‚æ•°è‡ªå®šä¹‰ç›‘å¬ç«¯å£ã€é™æ€ç›®å½•ã€æ—¥å¿—ã€SSL ç­‰
- **å†…ç½®EchoServerè°ƒè¯•æœåŠ¡**ï¼šæä¾›å®Œæ•´çš„è¯·æ±‚å›æ˜¾ã€å“åº”æ§åˆ¶ã€æµå¼é€šä¿¡åŠŸèƒ½

---

![æ¼”ç¤ºæˆªå›¾](https://gitee.com/o8oo8o/public/raw/master/webcurl/20260217_001.jpg)

---

![æ¼”ç¤ºæˆªå›¾](https://gitee.com/o8oo8o/public/raw/master/webcurl/20260217_002.jpg)

---

![æ¼”ç¤ºæˆªå›¾](https://gitee.com/o8oo8o/public/raw/master/webcurl/20260217_003.jpg)

---

### æ‰“èµæˆ‘ï¼š
* **æ¯ä¸€ä¸ªå¼€æºé¡¹ç›®çš„èƒŒåï¼Œéƒ½æœ‰ä¸€ç¾¤é»˜é»˜ä»˜å‡ºã€å……æ»¡æ¿€æƒ…çš„å¼€å‘è€…ã€‚ä»–ä»¬ç”¨è‡ªå·±çš„ä¸šä½™æ—¶é—´ï¼Œä¸æ–­åœ°ä¼˜åŒ–ä»£ç ã€ä¿®å¤bugã€æ’°å†™æ–‡æ¡£ï¼Œåªä¸ºè®©é¡¹ç›®å˜å¾—æ›´å¥½ã€‚å¦‚æœæ‚¨è§‰å¾—æˆ‘çš„é¡¹ç›®å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœæ‚¨è®¤å¯æˆ‘çš„åŠªåŠ›å’Œä»˜å‡ºï¼Œé‚£ä¹ˆè¯·è€ƒè™‘ç»™äºˆæˆ‘ä¸€ç‚¹å°å°çš„æ‰“èµï¼Œå‹æƒ…æç¤º:æ‰“èµä¸é€€ï¼Œæ€•è¢«åª³å¦‡æŸ¥åˆ°å¤§é¢æ”¯å‡ºğŸ¤¡ï¼Œå¦‚æœéœ€è¦æŠ€æœ¯æ”¯æŒï¼Œéœ€è¦æ”¶è´¹å“¦**
<br/>
<br/>

![æ‰“èµäºŒç»´ç ](https://gitee.com/o8oo8o/public/raw/master/pay.png)

[é¡¹ç›®æ¨è: https://github.com/o8oo8o/WebSSH ä¸€ä¸ªç½‘é¡µç‰ˆçš„SSHç®¡ç†å·¥å…·](https://github.com/o8oo8o/WebSSH "ä¸€ä¸ªç½‘é¡µç‰ˆçš„SSHç®¡ç†å·¥å…·")

<br/>


## ğŸ› ï¸ åŠŸèƒ½ç‰¹æ€§

### ğŸ”¥ æ ¸å¿ƒåŠŸèƒ½
- **ğŸŒ ç½‘é¡µç‰ˆ Postman ä½“éªŒ**ï¼šæ— éœ€å®‰è£…å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨å³ç”¨ï¼Œç•Œé¢ç¾è§‚ï¼ŒåŠŸèƒ½ä¸°å¯Œã€‚
- **ğŸ”„ HTTP è¯·æ±‚è½¬å‘**ï¼šå‰ç«¯é€šè¿‡ `/api/forward` æ¥å£å°†è¯·æ±‚å‚æ•°æäº¤ç»™åç«¯ï¼Œåç«¯ä»£ä¸ºè½¬å‘å¹¶è¿”å›ç»“æœï¼Œçªç ´æµè§ˆå™¨è·¨åŸŸé™åˆ¶ã€‚
- **æ”¯æŒ HTTP CONNECT ä»£ç†éš§é“**ï¼šæ”¯æŒ HTTP CONNECT æ–¹æ³•ï¼Œå¯ä½œä¸º HTTPS/SSH ç­‰åè®®çš„ä»£ç†éš§é“ï¼Œé€‚ç”¨äº curlã€sshã€ncat ç­‰å·¥å…·çš„ä»£ç†è½¬å‘ã€‚
- **ğŸ“ å¤šç§è¯·æ±‚ä½“æ”¯æŒ**ï¼šæ”¯æŒ `form-data`ï¼ˆå«å¤šæ–‡ä»¶ä¸Šä¼ ï¼‰ã€`x-www-form-urlencoded`ã€`json`ã€`text`ã€`xml`ã€`binary`ã€‚
- **ğŸ”§ è¯·æ±‚å¤´è‡ªå®šä¹‰**ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»æ„è¯·æ±‚å¤´ã€‚
- **ğŸ“¤ æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½**ï¼šæ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ ï¼Œå“åº”å†…å®¹å¯ç›´æ¥ä¸‹è½½ã€‚
- **ğŸ”„ è¯·æ±‚é‡è¯•ä¸è¶…æ—¶**ï¼šå¯é…ç½®é‡è¯•æ¬¡æ•°ã€é‡è¯•é—´éš”ã€è¶…æ—¶æ—¶é—´ã€‚
- **ğŸ”’ SSL éªŒè¯ä¸é‡å®šå‘**ï¼šå¯é€‰æ‹©æ˜¯å¦æ ¡éªŒ SSL è¯ä¹¦ã€æ˜¯å¦è‡ªåŠ¨è·Ÿéšé‡å®šå‘ã€‚
- **ğŸ“š å‰ç«¯åŠŸèƒ½ä¸°å¯Œ**ï¼šæ¥å£å†å²ã€æ¥å£é›†åˆã€å˜é‡æ›¿æ¢ã€å…¨å±€è¯·æ±‚å¤´ã€å¯¼å…¥å¯¼å‡ºç­‰ã€‚
- **âš™ï¸ å‘½ä»¤è¡Œçµæ´»é…ç½®**ï¼šæ”¯æŒè‡ªå®šä¹‰ç›‘å¬åœ°å€ã€ç«¯å£ã€é™æ€ç›®å½•ã€æ—¥å¿—ã€SSL è¯ä¹¦ç­‰ã€‚
- **âš¡ æè‡´è½»é‡**ï¼šå•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½“ç§¯ä»…çº¦ 10Mï¼Œéƒ¨ç½²ã€è¿ç§»ã€åˆ†å‘æå…¶æ–¹ä¾¿ã€‚
- **ğŸ’¾ æ— ä¾èµ–ã€æ˜“è¿ç»´**ï¼šæ— éœ€æ•°æ®åº“ã€æ— éœ€å¤–éƒ¨ä¾èµ–ï¼Œç›´æ¥è¿è¡Œã€‚
- **ğŸ–¥ï¸ è·¨å¹³å°/ä¿¡åˆ›å…¼å®¹**ï¼šæ”¯æŒä¸»æµæ“ä½œç³»ç»ŸåŠå›½äº§è½¯ç¡¬ä»¶å¹³å°ï¼Œé€‚åˆä¿¡åˆ›ç¯å¢ƒã€å†…ç½‘ã€ç¦»çº¿ç­‰ç‰¹æ®Šåœºæ™¯ã€‚
- **ğŸŒ ç½‘ç»œåè®®æ”¯æŒ**ï¼šå®Œç¾æ”¯æŒ IPv4 å’Œ IPv6 ç½‘ç»œåè®®ï¼Œé€‚åº”å„ç§ç½‘ç»œç¯å¢ƒã€‚
- **ğŸ”Œ å®æ—¶é€šä¿¡æ”¯æŒ**ï¼šåŸç”Ÿæ”¯æŒ WebSocket å’Œ SSEï¼ˆServer-Sent Eventsï¼‰ï¼Œæ»¡è¶³å®æ—¶æ•°æ®æ¨é€éœ€æ±‚ã€‚

### ğŸ¯ EchoServer è°ƒè¯•æœåŠ¡
- **ğŸ”„ æ™ºèƒ½è¯·æ±‚å›æ˜¾**ï¼šè‡ªåŠ¨è§£æå¹¶å›æ˜¾è¯·æ±‚çš„URLã€æ–¹æ³•ã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ï¼ˆæ–‡æœ¬ã€è¡¨å•ã€æ–‡ä»¶ã€äºŒè¿›åˆ¶ç­‰ï¼‰ã€‚
- **ğŸ›ï¸ çµæ´»å“åº”æ§åˆ¶**ï¼šæ”¯æŒé€šè¿‡è‡ªå®šä¹‰è¯·æ±‚å¤´æˆ–URLå‚æ•°çµæ´»æ§åˆ¶å“åº”å†…å®¹å’Œè¡Œä¸ºã€‚
- **ğŸ“Š å¤šç§å“åº”æ ¼å¼**ï¼šæ”¯æŒJSONã€XMLã€Textç­‰å¤šç§å“åº”æ ¼å¼ã€‚
- **â±ï¸ å“åº”å»¶è¿Ÿæ§åˆ¶**ï¼šå¯è‡ªå®šä¹‰å“åº”å»¶è¿Ÿæ—¶é—´ï¼Œæ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿåœºæ™¯ã€‚
- **ğŸ“¥ ä¸‹è½½å“åº”æ§åˆ¶**ï¼šæ”¯æŒå°†å“åº”å†…å®¹ä½œä¸ºæ–‡ä»¶ä¸‹è½½ã€‚
- **ğŸ”Œ æµå¼é€šä¿¡æ”¯æŒ**ï¼šSSEå’ŒWebSocketæ¥å£æ”¯æŒæµå¼æ•°æ®æ¨é€ã€‚
- **ğŸ¯ è‡ªå®šä¹‰æ•°æ®é˜Ÿåˆ—**ï¼šæ”¯æŒé¢„è®¾å“åº”æ•°æ®ï¼Œå®ç°è‡ªå®šä¹‰æµå¼æ¨é€ã€‚
- **ğŸ›¡ï¸ å¥å£®æ€§ä¿éšœ**ï¼šå†…ç½®panicæ¢å¤æœºåˆ¶ï¼Œé˜²æ­¢æœåŠ¡å´©æºƒã€‚

### ğŸŒ é™æ€æ–‡ä»¶æœåŠ¡å™¨
- **ğŸ“ å®Œæ•´æ–‡ä»¶æœåŠ¡**ï¼šç±»ä¼¼Nginxçš„é™æ€æ–‡ä»¶æœåŠ¡å™¨åŠŸèƒ½ï¼Œæ”¯æŒæ‰€æœ‰å¸¸è§æ–‡ä»¶ç±»å‹ã€‚
- **ğŸ¨ ä¸°å¯ŒMIMEæ”¯æŒ**ï¼šè‡ªåŠ¨è¯†åˆ«HTMLã€CSSã€JSã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€å­—ä½“ç­‰æ–‡ä»¶ç±»å‹ã€‚
- **ğŸ”’ å®‰å…¨é˜²æŠ¤**ï¼šé˜²æ­¢è·¯å¾„éå†æ”»å‡»ï¼Œç¡®ä¿æ–‡ä»¶è®¿é—®å®‰å…¨ã€‚
- **âš¡ é«˜æ€§èƒ½**ï¼šæ”¯æŒå¤§æ–‡ä»¶ä¼ è¾“ï¼Œå†…ç½®ç¼“å­˜æ§åˆ¶ã€‚
- **ğŸŒ CORSæ”¯æŒ**ï¼šå†…ç½®è·¨åŸŸèµ„æºå…±äº«æ”¯æŒï¼Œé€‚åˆå‰ç«¯å¼€å‘ã€‚
- **ğŸ“± ç§»åŠ¨å‹å¥½**ï¼šæ”¯æŒç§»åŠ¨è®¾å¤‡è®¿é—®ï¼Œå“åº”å¼è®¾è®¡ã€‚



### ğŸŒ MockæœåŠ¡

- **æ”¯æŒ Web é…ç½®**ï¼šå†…ç½® Admin æ§åˆ¶å°ï¼ˆé»˜è®¤ `/mock/`ï¼‰ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‹‰å–ã€ç¼–è¾‘ã€æ ¼å¼åŒ– `mock.json`ï¼Œæ— éœ€æ”¹æœ¬åœ°æ–‡ä»¶å³å¯æ”¹é…ç½®ã€‚
- **æ”¯æŒ Web çƒ­é‡è½½**ï¼šåœ¨ Admin ä¸­æäº¤é…ç½®åï¼ŒæœåŠ¡å°†æ–° JSON å†™å…¥æ–‡ä»¶å¹¶çƒ­é‡å¯ Mock æœåŠ¡ï¼Œæ— éœ€æ‰‹åŠ¨é‡å¯è¿›ç¨‹ã€‚
- **æ”¯æŒ Web å¯åœæ§åˆ¶**ï¼šé€šè¿‡ Admin çš„ Start / Stop / Restart æ§åˆ¶ Mock æœåŠ¡ç”Ÿå‘½å‘¨æœŸï¼ŒAdmin è‡ªèº«å¸¸é©»ï¼ŒMock åœæ­¢åä»å¯ç®¡ç†ã€‚
- **çº¯ JSON é…ç½®**ï¼šæ‰€æœ‰ Mock è¡Œä¸ºç”±ä¸€ä»½ `mock.json` å®šä¹‰ï¼Œæ— ä»£ç å³å¯å¢åˆ è·¯ç”±ã€æ”¹å“åº”ã€æŒ‚é™æ€èµ„æºä¸ WebSocket/SSEã€‚
- **å¤šç«¯å£å¤šåè®®ç›‘å¬**ï¼š`listen` æ”¯æŒå¤šç»„ host/portï¼Œæ¯ç»„å¯é… `http` ä¸ `https`ï¼Œå¹¶æ”¯æŒ `cert_file`/`key_file` é…ç½® TLSã€‚
- **REST è·¯å¾„å‚æ•°**ï¼šè·¯ç”± path æ”¯æŒ gorilla/mux é£æ ¼ï¼ˆå¦‚ `/api/user/{id}`ï¼‰ï¼Œè·¯å¾„å‚æ•°è‡ªåŠ¨æ³¨å…¥ä¸º `param.*` ä¾›æ¨¡æ¿ä¸æ¡ä»¶ä½¿ç”¨ã€‚
- **è¯·æ±‚é¢„åŒ¹é…ï¼ˆmatchï¼‰**ï¼šå¯æŒ‰ headers / query / body é…ç½® match æ¡ä»¶ï¼ˆheaders/query æ”¯æŒæ­£åˆ™ï¼Œbody æ”¯æŒç‚¹è·¯å¾„ä¸æ­£åˆ™ï¼‰ï¼Œå…¨éƒ¨æ»¡è¶³æ‰å‘½ä¸­è·¯ç”±ï¼Œå¦åˆ™ 404ã€‚
- **è·¯ç”±çº§ä¸å“åº”çº§ when**ï¼šè·¯ç”±å¯é… `when` ä¸æ»¡è¶³åˆ™ 403ï¼›å“åº”å¯é…å¤šæ¡ `when` åˆ†æ”¯ï¼ŒæŒ‰é¡ºåºåŒ¹é…é€‰ä¸€æ¡è¿”å›ï¼Œå®ç°æ¡ä»¶åˆ†æµã€‚
- **when è¡¨è¾¾å¼**ï¼šwhen çš„ value æ”¯æŒç­‰å€¼æˆ–æ“ä½œç¬¦å‰ç¼€ï¼š`=`ã€`!=`ã€`>`ã€`<`ã€`~`ï¼ˆæ­£åˆ™ï¼‰ã€`contains`ï¼Œå¯å†™å¦‚ `"query.age": ">18"`ã€`"header.X-Role": "~^admin$"`ã€‚
- **å˜é‡æå–ï¼ˆextractï¼‰**ï¼šä» body/query/header æŒ‰ç‚¹è·¯å¾„æå–å­—æ®µåˆ° `extract.*`ï¼Œä¾› whenã€å“åº” body/headers/cookiesã€æ¨¡æ¿ç»Ÿä¸€ä½¿ç”¨ã€‚
- **å¤šå“åº”åˆ†æ”¯**ï¼šå•è·¯ç”±ä¸‹å¯é…ç½®å¤šæ¡ responseï¼Œæ¯æ¡å¯æœ‰è‡ªå·±çš„ whenã€statusã€headersã€cookiesã€bodyã€fileã€delay_msï¼ŒæŒ‰ when é¡ºåºå‘½ä¸­å³è¿”å›ã€‚
- **æ¨¡æ¿å˜é‡**ï¼šå“åº” bodyã€headersã€cookiesã€file è·¯å¾„ã€template å†…å®¹ä¸­æ”¯æŒ `{{param.xxx}}`ã€`{{query.xxx}}`ã€`{{header.xxx}}`ã€`{{body.xxx}}`ã€`{{form.xxx}}`ã€`{{extract.xxx}}` ç­‰å‘½åç©ºé—´ã€‚
- **å¼ºç±»å‹å ä½ç¬¦**ï¼šæ”¯æŒ `{{@int:key}}`ã€`{{@float:key}}`ã€`{{@bool:key}}`ï¼Œåœ¨ JSON å“åº”ä¸­è¾“å‡ºæ•°å­—æˆ–å¸ƒå°”ç±»å‹è€Œéå­—ç¬¦ä¸²ã€‚
- **æ¨¡æ¿æ–‡ä»¶ï¼ˆ@filenameï¼‰**ï¼šbody æˆ– template å¯å†™ `@payloads/xxx.json`ï¼Œä»æœ¬åœ°æ–‡ä»¶è¯»å–å†…å®¹å¹¶åšå˜é‡æ›¿æ¢åè¿”å›ï¼Œä¾¿äºç»´æŠ¤å¤§å—å“åº”ã€‚
- **å“åº”ç›´æ¥å›æ–‡ä»¶**ï¼š`responses[].file` å¯æŒ‡å®šæœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆå¯å«æ¨¡æ¿å˜é‡ï¼‰ï¼Œç›´æ¥å°†æ–‡ä»¶å†…å®¹ä½œä¸º HTTP å“åº”ä½“è¿”å›ã€‚
- **å“åº”å»¶è¿Ÿï¼ˆdelay_msï¼‰**ï¼šå¯ä¸ºå•æ¡ response é…ç½®æ¯«ç§’çº§å»¶è¿Ÿï¼Œç”¨äºæ¨¡æ‹Ÿæ…¢æ¥å£æˆ–è¶…æ—¶åœºæ™¯ã€‚
- **å“åº” Cookie**ï¼šæ”¯æŒåœ¨ response ä¸­é…ç½® cookies æ•°ç»„ï¼ˆname/value/path/domain/expires/max_age/secure/http_only/same_siteï¼‰ï¼Œå€¼æ”¯æŒæ¨¡æ¿å˜é‡ã€‚
- **é™æ€èµ„æºæ‰˜ç®¡**ï¼š`static` å¯å°† URL å‰ç¼€æ˜ å°„åˆ°æœ¬åœ°ç›®å½•ï¼Œæ”¯æŒè‡ªå®šä¹‰ headersã€allow_methodsã€download æ¨¡å¼ï¼ˆContent-Disposition: attachmentï¼‰ã€‚
- **CORS é¢„æ£€å…œåº•**ï¼šå¯¹ OPTIONS è¯·æ±‚åšç»Ÿä¸€ CORS å¤´å…œåº•ï¼Œä¾¿äºå‰ç«¯è·¨åŸŸè°ƒç”¨ Mockã€‚
- **è¡¨å•ä¸æ–‡ä»¶ä¸Šä¼ **ï¼šè‡ªåŠ¨è§£æ `multipart/form-data` ä¸ `application/x-www-form-urlencoded`ï¼Œæ³¨å…¥ `form.xxx` åŠ `form.xxx.filename`/`form.xxx.size`ï¼Œå¯åœ¨ when ä¸æ¨¡æ¿ä¸­ä½¿ç”¨ã€‚
- **WebSocket Mock**ï¼šå¯é…ç½® websockets æ•°ç»„ï¼Œpath æ”¯æŒè·¯å¾„å‚æ•°ï¼ŒæŒ‰ script å‰§æœ¬é¡ºåºæ‰§è¡Œ sendã€awaitï¼ˆæ­£åˆ™æˆ– JSON ç­‰å€¼ï¼‰ã€delay_msã€timeout_msã€closeï¼Œæ¶ˆæ¯å†…å®¹æ”¯æŒæ¨¡æ¿å˜é‡ã€‚
- **SSEï¼ˆServer-Sent Eventsï¼‰**ï¼šå¯é…ç½® sse æ•°ç»„ï¼Œæ”¯æŒ path/method/match/headers/status/cookiesï¼Œevents å¯é… id/event/data/retry/delay_msï¼Œdata æ”¯æŒæ¨¡æ¿ï¼Œå¯é€‰ repeat å¾ªç¯æ¨é€ã€‚
- **æ— é…ç½®æ–‡ä»¶å¯åŠ¨**ï¼šè‹¥ `mock.json` ä¸å­˜åœ¨ï¼Œä»¥ç©ºé…ç½® `{}` å¯åŠ¨ï¼Œä»…å¼€æ”¾ Adminï¼Œä¾¿äºé¦–æ¬¡åœ¨ Web ä¸­ç¼–è¾‘å¹¶ä¿å­˜é…ç½®ã€‚



### ğŸ§° å¸¸ç”¨å·¥å…·ï¼ˆWebTools å·¥å…·ç®±ï¼‰

è®¿é—® `http://localhost:4444/tool` å³å¯ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š

#### ğŸ“ æ–‡æœ¬/ç¼–ç ç±»
- **JWTè§£æ**ï¼šä¸€é”®è§£æ JWT Tokenï¼ŒæŸ¥çœ‹ Header å’Œ Payload ä¿¡æ¯
- **UUIDç”Ÿæˆ**ï¼šæ‰¹é‡ç”Ÿæˆæ ‡å‡† UUIDï¼Œæ”¯æŒä¸€é”®å¤åˆ¶
- **æ—¶é—´æˆ³è½¬æ¢**ï¼šæ—¶é—´æˆ³ä¸æ—¥æœŸæ—¶é—´äº’è½¬ï¼Œæ”¯æŒç§’/æ¯«ç§’
- **Base64ç¼–è§£ç **ï¼šæ–‡æœ¬ç¼–ç /è§£ç ï¼Œæ”¯æŒæ–‡ä»¶è½¬Base64ã€Base64è½¬æ–‡ä»¶ä¸‹è½½
- **URLç¼–è§£ç **ï¼šURLç¼–ç /è§£ç ï¼Œæ”¯æŒURLå‚æ•°è§£æ
- **æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•å™¨**ï¼šå®æ—¶åŒ¹é…æµ‹è¯•ï¼Œæ”¯æŒ g/i/m/s æ ‡å¿—ï¼Œæ˜¾ç¤ºæ•è·ç»„

#### ğŸ” åŠ å¯†/å®‰å…¨ç±»
- **Hashè®¡ç®—**ï¼šæ”¯æŒæ–‡æœ¬å’Œæ–‡ä»¶çš„ SHA-256/SHA-1/SHA-384/SHA-512 å“ˆå¸Œè®¡ç®—
- **å¯¹ç§°åŠ å¯†/è§£å¯†**ï¼š
  - æ”¯æŒ AES-GCM/CBC/CTR ä¸‰ç§æ¨¡å¼
  - æ”¯æŒ 128/192/256 ä½å¯†é’¥é•¿åº¦
  - æ”¯æŒæ–‡æœ¬å’Œæ–‡ä»¶åŠ å¯†/è§£å¯†
- **RSA å¯†é’¥ç”Ÿæˆ**ï¼šç”Ÿæˆ 2048/4096 ä½å…¬ç§é’¥å¯¹ï¼ˆPEMæ ¼å¼ï¼‰
- **RSA-OAEP åŠ å¯†/è§£å¯†**ï¼šå…¬é’¥åŠ å¯†ã€ç§é’¥è§£å¯†ï¼Œæ”¯æŒæ–‡æœ¬å’Œå°æ–‡ä»¶
- **HMAC æ¶ˆæ¯è®¤è¯ç **ï¼šæ”¯æŒ SHA-256/384/512ï¼Œç”Ÿæˆå’ŒéªŒè¯æ¶ˆæ¯è®¤è¯ç 
- **æ•°å­—ç­¾å**ï¼š
  - æ”¯æŒ RSA-PSSã€RSASSA-PKCS1-v1_5ã€ECDSAã€Ed25519
  - ç”Ÿæˆå¯†é’¥å¯¹ã€ç­¾åã€éªŒè¯
- **å¯†é’¥äº¤æ¢**ï¼šECDH P-256/384/521ã€X25519ï¼ŒåŒæ–¹åå•†å…±äº«å¯†é’¥
- **å¯†é’¥æ´¾ç”Ÿ**ï¼šPBKDF2/HKDFï¼Œä»å¯†ç æ´¾ç”ŸåŠ å¯†å¯†é’¥
- **Tokenç”Ÿæˆå™¨**ï¼šè‡ªå®šä¹‰é•¿åº¦å’Œå­—ç¬¦ç±»å‹ï¼Œç”Ÿæˆéšæœº Token

#### ğŸ“Š æ•°æ®æ ¼å¼ç±»
- **JSONæ ¼å¼åŒ–**ï¼šJSONç¾åŒ–ã€å‹ç¼©ã€è½¬ä¹‰/åè½¬ä¹‰

#### ğŸ¨ å›¾åƒ/å¤šåª’ä½“ç±»
- **å›¾ç‰‡å¤„ç†**ï¼š
  - å›¾ç‰‡å‹ç¼©ï¼ˆå¯è°ƒè´¨é‡ï¼Œæ”¯æŒ JPEG/PNG/WebPï¼‰
  - å°ºå¯¸è°ƒæ•´ï¼ˆæ”¯æŒä¿æŒå®½é«˜æ¯”ï¼‰
  - å›¾ç‰‡è£å‰ªï¼ˆè‡ªå®šä¹‰åŒºåŸŸï¼‰
- **å½•å±å½•åƒ**ï¼š
  - å±å¹•å½•åˆ¶ï¼ˆæ”¯æŒç³»ç»ŸéŸ³é¢‘ï¼‰
  - æ‘„åƒå¤´å½•åƒï¼ˆæ”¯æŒé€‰æ‹©è®¾å¤‡ï¼‰
  - å½•åˆ¶åˆ—è¡¨ç®¡ç†ï¼ˆæ’­æ”¾/ä¸‹è½½/åˆ é™¤ï¼‰

#### ğŸ¨ å…¶ä»–å·¥å…·
- **é¢œè‰²è½¬æ¢å™¨**ï¼šHEX/RGB/HSL é¢œè‰²äº’è½¬
- **å®¢æˆ·ç«¯ä¿¡æ¯**ï¼š
  - æµè§ˆå™¨ä¿¡æ¯ï¼ˆUAã€å¹³å°ã€è¯­è¨€ã€ç¡¬ä»¶å¹¶å‘æ•°ç­‰ï¼‰
  - å±å¹•ä¿¡æ¯ï¼ˆåˆ†è¾¨ç‡ã€è‰²æ·±ã€åƒç´ æ¯”ï¼‰
  - ç½‘ç»œçŠ¶æ€ï¼ˆç½‘ç»œç±»å‹ã€ä¸‹è¡Œé€Ÿåº¦ã€RTTå»¶è¿Ÿï¼‰
  - åª’ä½“è®¾å¤‡ï¼ˆæ‘„åƒå¤´ã€éº¦å…‹é£ã€æ‰¬å£°å™¨ï¼‰
  - ç”µæ± çŠ¶æ€ï¼ˆç”µé‡ã€å……ç”µçŠ¶æ€ï¼‰
- **æœåŠ¡ç«¯ä¿¡æ¯**ï¼š
  - æ—¶é—´ä¿¡æ¯ï¼ˆæœåŠ¡å™¨æ—¶é—´ã€å®¢æˆ·ç«¯æ—¶é—´ã€æ—¶é—´å·®å¼‚ï¼‰
  - æ“ä½œç³»ç»Ÿï¼ˆç±»å‹ã€æ¶æ„ã€å®¶æ—ï¼‰
  - Goè¿è¡Œæ—¶ï¼ˆç‰ˆæœ¬ã€Goroutinesã€GCçŠ¶æ€ï¼‰
  - CPUä¿¡æ¯ï¼ˆæ ¸å¿ƒæ•°ã€å­—èŠ‚åºï¼‰
  - ç³»ç»Ÿå†…å­˜ï¼ˆæ€»å†…å­˜ã€å¯ç”¨å†…å­˜ã€ä½¿ç”¨ç‡ï¼‰
  - ç½‘ç»œæ¥å£ï¼ˆæ‰€æœ‰ç½‘å¡ä¿¡æ¯ã€IPåœ°å€ï¼‰
  - è¿›ç¨‹ä¿¡æ¯ï¼ˆPIDã€å·¥ä½œç›®å½•ã€æ‰§è¡Œè·¯å¾„ï¼‰
  - ç”¨æˆ·ä¿¡æ¯ï¼ˆUIDã€GIDã€ç”¨æˆ·åï¼‰
  - ç¯å¢ƒå˜é‡ï¼ˆæ‰€æœ‰ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼‰


---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç¼–è¯‘ & è¿è¡Œï¼ˆ30ç§’æå®šï¼‰

**æºç ç»“æ„æç®€**ï¼š
```
WebCurl/
â”œâ”€â”€ index.html    # å‰ç«¯ç•Œé¢ WebCurlï¼ˆçº¯åŸç”ŸHTML+JS+CSSï¼‰
â”œâ”€â”€ main.go       # åç«¯æœåŠ¡ WebCurl
â”œâ”€â”€ mock.html     # å‰ç«¯ç•Œé¢ WebMockï¼ˆçº¯åŸç”ŸHTML+JS+CSSï¼‰
â”œâ”€â”€ mock.go       # åç«¯æœåŠ¡ WebMock
â”œâ”€â”€ tool.html     # å‰ç«¯ç•Œé¢ WebToolsï¼ˆçº¯åŸç”ŸHTML+JS+CSSï¼‰
â”œâ”€â”€ ws.go         # åç«¯æœåŠ¡ WebSocket
â””â”€â”€ mux.go        # åç«¯æœåŠ¡ Muxè·¯ç”±
```

```bash
# ç¼–è¯‘
go build -o WebCurl main.go
# ä¹Ÿå¯ä»¥ä½¿ç”¨ sh build.sh å‘½ä»¤

# è¿è¡Œï¼ˆé»˜è®¤ 0.0.0.0:4444ï¼Œå†…åµŒå‰ç«¯é¡µé¢ï¼‰
./WebCurl

# æµè§ˆå™¨è®¿é—®
http://localhost:4444
```

> **æ³¨** ï¼šæ„å»ºæ‰€æœ‰å¹³å°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ `sh build.sh all` å‘½ä»¤ï¼Œæ„å»ºå®Œæˆååœ¨buildç›®å½•ä¸‹æŸ¥æ‰¾å¯¹åº”å¹³å°å¯æ‰§è¡Œæ–‡ä»¶ã€‚

### 2ï¸âƒ£ å‘½ä»¤è¡Œå‚æ•°

| å‚æ•°                | è¯´æ˜                                   | é»˜è®¤å€¼                |
|---------------------|----------------------------------------|-----------------------|
| `--host`            | ç›‘å¬åœ°å€                               | 0.0.0.0               |
| `--port`            | ç›‘å¬ç«¯å£                               | 4444                  |
| `--webroot`         | é™æ€æ–‡ä»¶æ ¹ç›®å½•ï¼ˆä¸ºç©ºç”¨å†…åµŒ index.htmlï¼‰| ç©º                    |
| `--daemon`          | åå°è¿è¡Œï¼ˆæ”¯æŒ Windows/Linux/Macï¼‰     | false                 |
| `--echo-server`     | æ˜¯å¦å¼€å¯EchoServerè°ƒè¯•æœåŠ¡              | true                  |
| `--log-level`       | æ—¥å¿—çº§åˆ«ï¼ˆerror, info, debugï¼‰         | error                 |
| `--log-file`        | æ—¥å¿—æ–‡ä»¶è·¯å¾„                           | post_api.log          |
| `--log-size`        | æ—¥å¿—æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆK/M/Gï¼‰              | 100M                  |
| `--ssl-cert`        | SSL è¯ä¹¦æ–‡ä»¶è·¯å¾„                       | ssl_cert.pem          |
| `--ssl-cert-key`    | SSL è¯ä¹¦å¯†é’¥è·¯å¾„                       | ssl_cert.key          |
| `--upload-dir`      | form-dataä¸Šä¼ æ–‡ä»¶ä¿å­˜ç›®å½•ï¼ˆä¸ºç©ºä»…é€ä¼ ï¼‰ | ç©º                    |
| `--stdout-log`      | æ˜¯å¦åœ¨æ§åˆ¶å°æ‰“å°æ—¥å¿—ï¼Œtrueä¸ºåŒæ—¶è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶ï¼Œfalseä»…è¾“å‡ºåˆ°æ–‡ä»¶ | true                  |

#### å¯åŠ¨ç¤ºä¾‹

```bash
# é»˜è®¤ï¼ˆ0.0.0.0:4444ï¼Œå†…åµŒindex.htmlï¼Œå¼€å¯EchoServerï¼‰
./WebCurl

# æŒ‡å®šç«¯å£å’Œhost
./WebCurl --host 127.0.0.1 --port 8888

# æŒ‡å®šé™æ€ç›®å½•
./WebCurl --webroot /tmp/www

# æ§åˆ¶æ—¥å¿—æ˜¯å¦è¾“å‡ºåˆ°æ§åˆ¶å°
./WebCurl --stdout-log=false

# å¼€å¯é™æ€æ–‡ä»¶æœåŠ¡å™¨æ¨¡å¼ï¼ˆæŒ‡å®šç›®å½•ï¼‰
./WebCurl --webroot /mnt/webroot

# å…³é—­EchoServerè°ƒè¯•æœåŠ¡
./WebCurl --echo-server=false

# åå°è¿è¡Œï¼ˆLinux/MacOS/Windowsï¼‰
./WebCurl --daemon

# ç»„åˆ
./WebCurl --host 0.0.0.0 --port 9000 --webroot /tmp/www --daemon --stdout-log=false

```

### ğŸ³ å®¹å™¨åŒ–éƒ¨ç½² Â· æé€Ÿä¸Šäº‘

### ğŸš€ ä¸€é”® Docker éƒ¨ç½²

WebCurl å¤©ç”Ÿé€‚åˆå®¹å™¨åŒ–ï¼Œæ”¯æŒ Docker/Kubernetes ç­‰ä¸»æµäº‘åŸç”Ÿç¯å¢ƒï¼Œè½»æ¾å®ç°å¼¹æ€§æ‰©å±•ä¸è‡ªåŠ¨åŒ–è¿ç»´ï¼

#### 1ï¸âƒ£ Docker é•œåƒæ„å»ºä¸è¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t webcurl:2.2 .

# è¿è¡Œå®¹å™¨ï¼ˆé»˜è®¤ 0.0.0.0:4444ï¼‰
docker run -d -p:4444:4444 --name webcurl  webcurl:2.2

# æŒ‡å®šæ•°æ®/é™æ€ç›®å½•æŒ‚è½½
docker run -d --name webcurl -p 4444:4444 -v /usr/share/nginx/html/:/usr/local/WebCurl/webroot webcurl:2.2 /usr/local/WebCurl/WebCurl --webroot=/usr/local/WebCurl/webroot
```

#### 2ï¸âƒ£ Kubernetes æé€Ÿéƒ¨ç½²

WebCurl å®Œç¾å…¼å®¹ K8Sï¼Œæ”¯æŒæ— çŠ¶æ€éƒ¨ç½²ã€å¼¹æ€§ä¼¸ç¼©ã€å¥åº·æ£€æŸ¥ç­‰ä¼ä¸šçº§éœ€æ±‚ã€‚

**ç¤ºä¾‹ Deployment é…ç½®ï¼š**

```yaml
######################################
apiVersion: apps/v1
kind: Deployment
metadata:
  name: webcurl
spec:
  replicas: 1
  selector:
    matchLabels:
      app: webcurl
  template:
    metadata:
      labels:
        app: webcurl
    spec:
      containers:
      - name: webcurl
        image: webcurl:2.2
        ports:
        - containerPort: 4444
#        args: ["/usr/local/WebCurl/WebCurl","--echo-server=true","--port=4444"]
---
apiVersion: v1
kind: Service
metadata:
  name: webcurl
spec:
  type: NodePort
  ports:
    - port: 4444
      targetPort: 4444
      nodePort: 30444
  selector:
    app: webcurl
######################################
```

> åªéœ€ `kubectl apply -f webcurl.yaml`ï¼Œå³å¯åœ¨ K8s é›†ç¾¤ä¸­å¼¹æ€§éƒ¨ç½² WebCurlï¼

### ğŸŒˆ å®¹å™¨åŒ–ä¼˜åŠ¿

- **æè‡´è½»é‡**ï¼šå•ä¸€äºŒè¿›åˆ¶+æç®€é•œåƒï¼Œå¯åŠ¨å¿«ã€èµ„æºå ç”¨ä½
- **äº‘åŸç”Ÿå‹å¥½**ï¼šæ— çŠ¶æ€è®¾è®¡ï¼Œå¤©ç„¶é€‚é… K8Sã€Dockerã€OpenShift ç­‰å¹³å°
- **å¼¹æ€§æ‰©å±•**ï¼šæ”¯æŒå‰¯æœ¬æ¨ªå‘æ‰©å±•ï¼Œè½»æ¾åº”å¯¹é«˜å¹¶å‘
- **è‡ªåŠ¨åŒ–è¿ç»´**ï¼šæ”¯æŒå¥åº·æ£€æŸ¥ã€æ—¥å¿—æŒ‚è½½ã€é…ç½®æ³¨å…¥
- **ä¸€é”®è¿ç§»**ï¼šé•œåƒå³æœåŠ¡ï¼Œéšæ—¶éšåœ°éƒ¨ç½²åˆ°ä»»æ„äº‘/é›†ç¾¤/æœ¬åœ°

---

**WebCurlï¼Œè®© API è°ƒè¯•ä¸æµ‹è¯•åƒéƒ¨ç½²é™æ€ç½‘ç«™ä¸€æ ·ç®€å•ï¼Œè½»æ¾ä¸Šäº‘ï¼Œéšæ—¶éšåœ°ï¼Œå®‰å…¨é«˜æ•ˆï¼**

---

## ğŸ¯ é€‚ç”¨åœºæ™¯

### ğŸ’¼ ä¼ä¸šçº§åº”ç”¨
- **å†…ç½‘ç¯å¢ƒ**ï¼šæ•°æ®ä¸å‡ºå†…ç½‘ï¼Œå®‰å…¨å¯æ§
- **ä¿¡åˆ›ç¯å¢ƒ**ï¼šå®Œç¾æ”¯æŒå›½äº§èŠ¯ç‰‡å’Œæ“ä½œç³»ç»Ÿ
- **ç¦»çº¿éƒ¨ç½²**ï¼šæ— ç½‘ç»œç¯å¢ƒä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨
- **å›¢é˜Ÿåä½œ**ï¼šé…ç½®å¯å¯¼å‡ºåˆ†äº«ï¼Œä¾¿äºå›¢é˜Ÿç»Ÿä¸€

### ğŸ‘¨â€ğŸ’» å¼€å‘è€…æ—¥å¸¸
- **æ¥å£è”è°ƒ**ï¼šå‰åç«¯æ¥å£è°ƒè¯•å¿…å¤‡
- **APIæµ‹è¯•**ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•å‰çš„æ¥å£éªŒè¯
- **è·¨åŸŸè°ƒè¯•**ï¼šå®Œç¾è§£å†³å‰ç«¯è·¨åŸŸé—®é¢˜
- **æ–‡ä»¶ä¸Šä¼ æµ‹è¯•**ï¼šæ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ æµ‹è¯•
- **æ¥å£è°ƒè¯•**ï¼šEchoServeræä¾›å®Œæ•´çš„è¯·æ±‚å›æ˜¾å’Œå“åº”æ§åˆ¶

### ğŸ”§ è¿ç»´æµ‹è¯•
- **æ¥å£ç›‘æ§**ï¼šå®šæœŸæµ‹è¯•å…³é”®æ¥å£çŠ¶æ€
- **æ€§èƒ½æµ‹è¯•**ï¼šæ”¯æŒé‡è¯•å’Œè¶…æ—¶é…ç½®
- **SSLæµ‹è¯•**ï¼šSSLè¯ä¹¦éªŒè¯æµ‹è¯•
- **é‡å®šå‘æµ‹è¯•**ï¼šè‡ªåŠ¨è·Ÿéšé‡å®šå‘æµ‹è¯•
- **å®æ—¶é€šä¿¡æµ‹è¯•**ï¼šWebSocketè¿æ¥å’ŒSSEäº‹ä»¶æµæµ‹è¯•
- **ç½‘ç»œå»¶è¿Ÿæ¨¡æ‹Ÿ**ï¼šEchoServeræ”¯æŒå“åº”å»¶è¿Ÿæ§åˆ¶

### ğŸŒ é™æ€æ–‡ä»¶æœåŠ¡
- **ç½‘ç«™æ‰˜ç®¡**ï¼šå¿«é€Ÿéƒ¨ç½²é™æ€ç½‘ç«™ï¼Œæ”¯æŒHTMLã€CSSã€JSç­‰
- **æ–‡ä»¶åˆ†äº«**ï¼šä¼ä¸šå†…éƒ¨æ–‡ä»¶åˆ†äº«å’Œä¸‹è½½æœåŠ¡
- **å¼€å‘ç¯å¢ƒ**ï¼šå‰ç«¯å¼€å‘æ—¶çš„æœ¬åœ°æ–‡ä»¶æœåŠ¡å™¨
- **æ–‡æ¡£æœåŠ¡**ï¼šAPIæ–‡æ¡£ã€æŠ€æœ¯æ–‡æ¡£çš„åœ¨çº¿è®¿é—®
- **èµ„æºæ‰˜ç®¡**ï¼šå›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰å¤šåª’ä½“èµ„æºæ‰˜ç®¡
- **CDNæ›¿ä»£**ï¼šå°å‹é¡¹ç›®çš„CDNæœåŠ¡æ›¿ä»£æ–¹æ¡ˆ

---

## ğŸ“– å‰ç«¯ä½¿ç”¨è¯´æ˜

### 1. è®¿é—®é¡µé¢

å¯åŠ¨åï¼Œæµè§ˆå™¨è®¿é—® `http://localhost:4444`ï¼Œå³å¯è¿›å…¥ Postman é£æ ¼çš„è°ƒè¯•é¡µé¢ã€‚
å¯åŠ¨åï¼Œæµè§ˆå™¨è®¿é—® `http://localhost:4444/mock`ï¼Œå³å¯è¿›å…¥ Mock æœåŠ¡å™¨jsoné…ç½®é¡µé¢ï¼Œè¯¦ç»†é…ç½®è§ä¸‹æ–‡ã€‚

### 2. è¯·æ±‚æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢

- å‰ç«¯ä¼šè‡ªåŠ¨è¯·æ±‚ `/api/mode`ï¼Œå¦‚è¿”å› `{ "mode": "proxy" }`ï¼Œåˆ™æ‰€æœ‰è¯·æ±‚å°†é€šè¿‡åç«¯ `/api/forward` è½¬å‘ï¼Œè§£å†³è·¨åŸŸé—®é¢˜ã€‚
- å¦åˆ™ï¼Œå‰ç«¯ç›´æ¥ç”¨ fetch å‘èµ·è¯·æ±‚ã€‚

### 3. å‘é€è¯·æ±‚ï¼ˆä»£ç†æ¨¡å¼ï¼‰

- æ”¯æŒ GET/POST/PUT/DELETE/PATCH/HEAD/OPTIONS ç­‰æ–¹æ³•
- æ”¯æŒå¤šç§è¯·æ±‚ä½“æ ¼å¼ã€æ–‡ä»¶ä¸Šä¼ ã€è¯·æ±‚å¤´è‡ªå®šä¹‰
- æ”¯æŒå˜é‡æ›¿æ¢ã€å…¨å±€å¤´ã€æ¥å£é›†åˆã€å†å²è®°å½•ç­‰
- æ”¯æŒè¯·æ±‚å‚æ•°ã€é‡è¯•ã€è¶…æ—¶ã€SSL éªŒè¯ã€é‡å®šå‘ç­‰é«˜çº§é€‰é¡¹

---

## ğŸ”§ åç«¯æ¥å£è¯´æ˜

### 1. `/api/forward`ï¼ˆPOSTï¼‰

ç”¨äºå‰ç«¯é€šè¿‡ form-data æ–¹å¼æäº¤è¯·æ±‚å‚æ•°ï¼Œç”±åç«¯è½¬å‘åˆ°ç›®æ ‡æ¥å£ã€‚

#### æ”¯æŒçš„ form-data å­—æ®µ

| å­—æ®µå         | ç±»å‹/è¯´æ˜         | ç¤ºä¾‹/è¯´æ˜                                  |
|----------------|------------------|--------------------------------------------|
| url            | string           | ç›®æ ‡æ¥å£åœ°å€                               |
| time_out       | int              | è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œ0ä¸ºä¸è¶…æ—¶                  |
| retry_count    | int              | é‡è¯•æ¬¡æ•°ï¼Œ0ä¸ºä¸é‡è¯•                        |
| retry_delay    | int              | é‡è¯•é—´éš”ï¼ˆç§’ï¼‰ï¼Œ0ä¸ºæ— é—´éš”                  |
| method         | string           | è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤ GET                         |
| body_type      | string           | è¯·æ±‚ä½“ç±»å‹ï¼Œè§ä¸‹è¡¨                         |
| headers        | jsonå­—ç¬¦ä¸²       | `[{"name":"X-Token","value":"abc"}]`       |
| file_info      | jsonå­—ç¬¦ä¸²       | `[{"field_name":"files","file_name":"a.txt"}]` |
| files          | æ–‡ä»¶             | æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼                              |
| body           | string           | è¯·æ±‚ä½“å†…å®¹ï¼ˆjson/xml/textç­‰ï¼‰              |
| verify_ssl     | Y/N              | æ˜¯å¦æ ¡éªŒSSLï¼Œé»˜è®¤Y                         |
| follow_redirect| Y/N              | æ˜¯å¦è‡ªåŠ¨è·Ÿéšé‡å®šå‘ï¼Œé»˜è®¤Y                  |

#### body_type æ”¯æŒ

- `form-data`ï¼šå¤šæ–‡ä»¶ä¸Šä¼ ï¼Œè¡¨å•å‚æ•°
- `x-www-form-urlencoded`ï¼šæ ‡å‡†è¡¨å•
- `json`ï¼šapplication/json
- `text`ï¼štext/plain
- `xml`ï¼šapplication/xml
- `binary`ï¼šäºŒè¿›åˆ¶æ–‡ä»¶ä¸Šä¼ 
- `none`ï¼šæ— è¯·æ±‚ä½“

### 2. `/api/mode`ï¼ˆGETï¼‰

è¿”å›å½“å‰åç«¯æ¨¡å¼ï¼Œå‰ç«¯æ®æ­¤åˆ¤æ–­æ˜¯å¦éœ€è¦é€šè¿‡åç«¯è½¬å‘ã€‚

**è¿”å›ç¤ºä¾‹**

```json
{ "mode": "proxy" }
```

### 3. EchoServer è°ƒè¯•æ¥å£

#### 3.1 `/api/echo`ï¼ˆæ‰€æœ‰HTTPæ–¹æ³•ï¼‰

**åŠŸèƒ½**ï¼šæ™ºèƒ½è¯·æ±‚å›æ˜¾ï¼Œæ”¯æŒçµæ´»çš„å“åº”æ§åˆ¶ã€‚

**ç‰¹æ€§**ï¼š
- æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³•ï¼ˆGETã€POSTã€PUTã€DELETEã€PATCHã€HEADã€OPTIONSç­‰ï¼‰
- è‡ªåŠ¨è§£æå¹¶å›æ˜¾è¯·æ±‚çš„URLã€æ–¹æ³•ã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“
- æ”¯æŒæ–‡æœ¬ã€è¡¨å•ã€æ–‡ä»¶ä¸Šä¼ ã€äºŒè¿›åˆ¶ç­‰å¤šç§è¯·æ±‚ä½“ç±»å‹
- æ”¯æŒé€šè¿‡è‡ªå®šä¹‰è¯·æ±‚å¤´æˆ–URLå‚æ•°çµæ´»æ§åˆ¶å“åº”

**å“åº”æ§åˆ¶å‚æ•°**ï¼š

| è¯·æ±‚å¤´                  | ä½œç”¨                                                | ç¤ºä¾‹å€¼                         |
|-------------------------|---------------------------------------------------|--------------------------------|
| X-Response-Status-Code  | æ§åˆ¶HTTPå“åº”çŠ¶æ€ç                                 | 201ã€404ã€500                  |
| X-Response-Location     | è®¾ç½®å“åº”Locationå¤´                               | https://www.qq.com             |
| X-Response-Headers      | æ‰¹é‡è®¾ç½®å“åº”å¤´ï¼ˆJSONå­—ç¬¦ä¸²ï¼Œé”®å€¼å¯¹ï¼‰              | {"X-Foo":"Bar"}              |
| X-Response-Type         | æ§åˆ¶å“åº”ä½“æ ¼å¼ï¼ˆjson/xml/textï¼‰                 | jsonã€xmlã€text                      |
| X-Response-Sleep        | æ§åˆ¶å“åº”å»¶è¿Ÿï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰                       | 200ã€1000                      |
| X-Response-Body         | æŒ‡å®šBase64ç¼–ç çš„å“åº”bodyå†…å®¹ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰        | `eyJtc2ciOiJoZWxsbyJ9`         |
| X-Response-Download     | æ§åˆ¶å“åº”ä¸ºä¸‹è½½ï¼ŒæŒ‡å®šä¸‹è½½æ–‡ä»¶å                     | data.txtã€result.json          |

**å‚æ•°ä¼ é€’æ–¹å¼**ï¼š
- æ”¯æŒè¯·æ±‚å¤´æ–¹å¼ï¼š`curl -H "X-Response-Status-Code: 202" http://localhost:4444/api/echo`
- æ”¯æŒURLå‚æ•°æ–¹å¼ï¼š`curl "http://localhost:4444/api/echo?X-Response-Status-Code=202"`
- **è¯·æ±‚å¤´ä¼˜å…ˆçº§é«˜äºURLå‚æ•°**

**åŸºæœ¬ç”¨æ³•ç¤ºä¾‹**ï¼š
```bash
# æ™®é€šè¯·æ±‚
curl -X GET http://localhost:4444/api/echo
curl -X POST -d 'Hello World' http://localhost:4444/api/echo

# è¡¨å•ä¸æ–‡ä»¶ä¸Šä¼ 
curl -X POST -F 'text=Hello' -F 'file=@/path/to/file' http://localhost:4444/api/echo

# æ§åˆ¶å“åº”çŠ¶æ€ç 
curl -H "X-Response-Status-Code: 202" http://localhost:4444/api/echo

# æ§åˆ¶å“åº”ç±»å‹
curl -H "X-Response-Type: xml" http://localhost:4444/api/echo
curl -H "X-Response-Type: text" -d "a simple text body" http://localhost:4444/api/echo

# æ§åˆ¶å“åº”å»¶è¿Ÿ
curl -H "X-Response-Sleep: 500" http://localhost:4444/api/echo

# è‡ªå®šä¹‰å“åº”ä½“ï¼ˆBase64ç¼–ç ï¼‰
curl -H "X-Response-Body: eyJtc2ciOiJoZWxsbyJ9" http://localhost:4444/api/echo

# ä¸‹è½½å“åº”å†…å®¹
curl -H "X-Response-Download: data.txt" http://localhost:4444/api/echo -OJ
```

**å“åº”ç»“æ„**ï¼š
```json
{
  "method": "POST",
  "url": "http://localhost:4444/api/echo",
  "headers": [
    {"key": "Content-Type", "value": "application/json"},
    ...
  ],
  "body": "Hello World"
}
```

#### 3.2 `/api/sse/echo`ï¼ˆSSEæµå¼æ¥å£ï¼‰

**åŠŸèƒ½**ï¼šServer-Sent Eventsæµå¼å›æ˜¾ï¼Œé€‚åˆå‰ç«¯æµå¼æ¶ˆè´¹ã€‚

**ç‰¹æ€§**ï¼š
- æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³•
- è¿”å›SSEæµï¼Œæ¯æ¡æ¶ˆæ¯ä¸ºJSON
- æ”¯æŒè‡ªå®šä¹‰å“åº”å‚æ•°
- æ”¯æŒæµå¼æ•°æ®æ¨é€

**é¢å¤–å‚æ•°**ï¼š
- `X-Response-Sse-Count`ï¼šSSEæ¶ˆæ¯æ¡æ•°ï¼Œé»˜è®¤100
- `X-Response-Sleep`ï¼šæ¯æ¡SSEæ¶ˆæ¯é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤500

**ç”¨æ³•ç¤ºä¾‹**ï¼š
```bash
# åŸºæœ¬SSEè¯·æ±‚
curl http://localhost:4444/api/sse/echo

# POSTå¸¦body
curl -X POST -d 'Hello SSE' http://localhost:4444/api/sse/echo

# æ§åˆ¶SSEæ¶ˆæ¯æ¡æ•°å’Œé—´éš”
curl -H "X-Response-Sse-Count: 5" -H "X-Response-Sleep: 1000" http://localhost:4444/api/sse/echo

# SSEä¸Šä¼ æ–‡ä»¶
curl -X POST -F 'file=@/path/to/file' http://localhost:4444/api/sse/echo
```

#### 3.3 `/api/ws/echo`ï¼ˆWebSocketæ¥å£ï¼‰

**åŠŸèƒ½**ï¼šWebSocketæµå¼å›æ˜¾ï¼Œé€‚åˆå‰ç«¯WebSocketæµå¼æ¶ˆè´¹ã€‚

**ç‰¹æ€§**ï¼š
- æ”¯æŒWebSocketåè®®ï¼Œå‡çº§è¿æ¥åæ¨é€å¤šæ¡æ¶ˆæ¯
- æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³•ï¼ˆWebSocketä»…å‡çº§GETï¼Œå…¶ä»–æ–¹æ³•é€šè¿‡headerä¼ é€’ï¼‰
- æ”¯æŒè‡ªå®šä¹‰å“åº”å‚æ•°

**é¢å¤–å‚æ•°**ï¼š
- `X-Response-Websocket-Count`ï¼šWebSocketæ¶ˆæ¯æ¡æ•°ï¼Œé»˜è®¤100
- `X-Response-Sleep`ï¼šæ¯æ¡æ¶ˆæ¯é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤500

**ç”¨æ³•ç¤ºä¾‹**ï¼š
```bash
# WebSocketåŸºæœ¬è¯·æ±‚ï¼ˆéœ€WebSocketå®¢æˆ·ç«¯ï¼‰
wscat -c ws://localhost:4444/api/ws/echo

# æ§åˆ¶æ¶ˆæ¯æ¡æ•°å’Œé—´éš”
wscat -c "ws://localhost:4444/api/ws/echo?X-Response-Websocket-Count=5&X-Response-Sleep=1000"

# WebSocketè‡ªå®šä¹‰å“åº”å†…å®¹ï¼ˆBase64ï¼‰
wscat -c "ws://localhost:4444/api/ws/echo?X-Response-Body=eyJtc2ciOiJoZWxsbyB3cyJ9"
```

#### 3.4 è‡ªå®šä¹‰æ•°æ®é˜Ÿåˆ—æ¥å£

**`POST /api/sse/set`**ï¼šè®¾ç½®SSEå“åº”çš„æ¶ˆæ¯é˜Ÿåˆ—
**`POST /api/ws/set`**ï¼šè®¾ç½®WebSocketå“åº”çš„æ¶ˆæ¯é˜Ÿåˆ—

**åŠŸèƒ½**ï¼šé¢„è®¾å“åº”æ•°æ®ï¼Œå®ç°è‡ªå®šä¹‰æµå¼æ¨é€ã€‚

**è¯·æ±‚ä½“æ ¼å¼**ï¼š
```json
[
  {"value": {"v": 1, "data": "mydata"}},
  {"value": {"v": 2, "data": 123}},
  {"value": "mydata"},
  {"value": null},
  {"value": 123}
]
```

#### 3.5 å“åº”æ¨¡å¼æ§åˆ¶

é€šè¿‡è¯·æ±‚å¤´ `X-Response-Mode` æ§åˆ¶SSE/WSå“åº”è¡Œä¸ºï¼š

- `default`ï¼ˆé»˜è®¤ï¼‰ï¼šåŸæœ‰å›æ˜¾é€»è¾‘ï¼Œè‡ªåŠ¨å›æ˜¾è¯·æ±‚å†…å®¹
- `user`ï¼šä»é¢„è®¾é˜Ÿåˆ—ä¸­ä¾æ¬¡å–å‡ºvalueä½œä¸ºå“åº”ä½“
- `react`ï¼šè¿æ¥å»ºç«‹åç­‰å¾…ç”¨æˆ·æ¨é€æ•°æ®ï¼ˆWebSocketä¸“ç”¨ï¼‰

**ç”¨æ³•ç¤ºä¾‹**ï¼š
```bash
# è®¾ç½®SSEé˜Ÿåˆ—
curl -X POST -H "Content-Type: application/json" \
  -d '[{"value":{"v":1,"data":"mydata"}}, {"value":{"v":2,"data":123}}]' \
  http://localhost:4444/api/sse/set

# SSE useræ¨¡å¼æ¶ˆè´¹
curl -H "X-Response-Mode: user" http://localhost:4444/api/sse/echo

# è®¾ç½®WSé˜Ÿåˆ—
curl -X POST -H "Content-Type: application/json" \
  -d '[{"value":{"v":1,"data":"mydata"}}, {"value":{"v":2,"data":123}}]' \
  http://localhost:4444/api/ws/set

# WS useræ¨¡å¼æ¶ˆè´¹
wscat -c "ws://localhost:4444/api/ws/echo?X-Response-Mode=user"
```

### 4. HTTP CONNECT ä»£ç†éš§é“æ”¯æŒ

**åŠŸèƒ½**ï¼šæ”¯æŒ HTTP CONNECT æ–¹æ³•ï¼Œå¯ä½œä¸º HTTPS/SSH ç­‰åè®®çš„ä»£ç†éš§é“ã€‚

- å¯ç›´æ¥ä½œä¸º curlã€sshã€ncat ç­‰å·¥å…·çš„ HTTP ä»£ç†æœåŠ¡å™¨ã€‚
- é€šè¿‡ CONNECT å»ºç«‹ TCP éš§é“ï¼Œæ”¯æŒ HTTPSã€WebSocketã€SSH ç­‰åè®®çš„è½¬å‘ã€‚
- é€‚åˆä¼ä¸šå†…ç½‘ã€å¼€å‘æµ‹è¯•ç­‰éœ€è¦ä»£ç†éš§é“çš„åœºæ™¯ã€‚

**ç”¨æ³•ç¤ºä¾‹**ï¼š

```bash
# curl é€šè¿‡ HTTP ä»£ç†è®¿é—® HTTPS ç«™ç‚¹
curl -k -x http://localhost:4444 https://www.example.com

# ssh é€šè¿‡ HTTP ä»£ç†
ssh -o "ProxyCommand ncat --proxy 127.0.0.1:4444 --proxy-type http %h %p" user@host
```

- è¯¥åŠŸèƒ½æ— éœ€é¢å¤–é…ç½®ï¼ŒæœåŠ¡å¯åŠ¨åè‡ªåŠ¨æ”¯æŒã€‚
- æ—¥å¿—ä¸­ä¼šè®°å½• CONNECT éš§é“çš„å»ºç«‹ä¸å…³é—­ã€‚

---

## ğŸ¨ å‰ç«¯é«˜çº§åŠŸèƒ½

- **ğŸ“Š æ¥å£å†å²**ï¼šè‡ªåŠ¨ä¿å­˜æœ€è¿‘ 50 æ¡è¯·æ±‚å†å²ï¼Œæ”¯æŒä¸€é”®åŠ è½½ã€å¯¼å…¥å¯¼å‡ºã€æ¸…ç©º
- **ğŸ“š æ¥å£é›†åˆ**ï¼šæ”¯æŒå¤šé›†åˆç®¡ç†ï¼Œæ¥å£ä¿å­˜ã€å¯¼å…¥å¯¼å‡ºã€åˆ é™¤
- **ğŸ”§ å˜é‡ç®¡ç†**ï¼šæ”¯æŒå˜é‡å®šä¹‰ä¸æ›¿æ¢ï¼Œä¾¿äºç¯å¢ƒåˆ‡æ¢
- **ğŸ›ï¸ å…¨å±€è¯·æ±‚å¤´**ï¼šæ”¯æŒå…¨å±€å¤´é…ç½®ï¼Œè‡ªåŠ¨åˆå¹¶åˆ°æ¯æ¬¡è¯·æ±‚
- **âš™ï¸ è¯·æ±‚é…ç½®**ï¼šæ”¯æŒ SSL éªŒè¯ã€é‡å®šå‘ã€è¶…æ—¶ã€é‡è¯•ã€ç¼“å­˜ã€modeã€credentialsã€referrerPolicy ç­‰é«˜çº§ fetch é€‰é¡¹
- **ğŸ’¾ å¯¼å…¥å¯¼å‡º**ï¼šæ”¯æŒå…¨éƒ¨é…ç½®ä¸€é”®å¯¼å…¥å¯¼å‡ºï¼Œä¾¿äºè¿ç§»å’Œå¤‡ä»½
- **ğŸª Hookè„šæœ¬**ï¼šæ”¯æŒå‰ç½®è„šæœ¬å’Œåç½®è„šæœ¬ï¼Œå¯åœ¨è¯·æ±‚å‘é€å‰å’Œå“åº”è¿”å›åæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘

---

## ğŸª Hook è„šæœ¬åŠŸèƒ½

Hook è„šæœ¬åŠŸèƒ½å…è®¸ä½ åœ¨è¯·æ±‚å‘é€å‰ï¼ˆPre-Requestï¼‰å’Œå“åº”è¿”å›åï¼ˆPost-Responseï¼‰æ‰§è¡Œè‡ªå®šä¹‰ JavaScript ä»£ç ï¼Œå®ç°åŠ¨æ€ä¿®æ”¹è¯·æ±‚å‚æ•°ã€æå–å“åº”æ•°æ®ã€è‡ªåŠ¨ä¿å­˜å˜é‡ç­‰é«˜çº§åŠŸèƒ½ã€‚

### ğŸ“ å…¥å£ä½ç½®

åœ¨è¯·æ±‚åŒºåŸŸç‚¹å‡» **"è„šæœ¬"** æ ‡ç­¾é¡µï¼Œå¯ä»¥çœ‹åˆ°ï¼š
- **Pre-Request Hookï¼ˆå‰ç½®è„šæœ¬ï¼‰**ï¼šè¯·æ±‚å‘é€å‰æ‰§è¡Œ
- **Post-Response Hookï¼ˆåç½®è„šæœ¬ï¼‰**ï¼šå“åº”è¿”å›åæ‰§è¡Œ
- **æ§åˆ¶å°è¾“å‡º**ï¼šæ˜¾ç¤ºè„šæœ¬æ‰§è¡Œæ—¥å¿—

### ğŸ”§ Pre-Request Hookï¼ˆå‰ç½®è„šæœ¬ï¼‰

å‰ç½®è„šæœ¬åœ¨è¯·æ±‚å‘é€å‰æ‰§è¡Œï¼Œå¯ä»¥åŠ¨æ€ä¿®æ”¹è¯·æ±‚å‚æ•°ã€‚

#### å‡½æ•°ç­¾å

```javascript
function preRequest(request) {
    // request åŒ…å«ä»¥ä¸‹å±æ€§ï¼š
    // - url: è¯·æ±‚URLï¼ˆå¯ä¿®æ”¹ï¼‰
    // - method: è¯·æ±‚æ–¹æ³•ï¼ˆå¯ä¿®æ”¹ï¼‰
    // - headers: è¯·æ±‚å¤´å¯¹è±¡ï¼ˆå¯ä¿®æ”¹ï¼‰
    // - body: è¯·æ±‚ä½“ï¼ˆå¯ä¿®æ”¹ï¼‰
    // - bodyType: è¯·æ±‚ä½“ç±»å‹
    // - settings: è¯·æ±‚è®¾ç½®
    // - variables: å½“å‰æ‰€æœ‰å˜é‡ï¼ˆåªè¯»ï¼‰
    // - utils: å·¥å…·å‡½æ•°é›†
    
    return request;  // å¿…é¡»è¿”å› request å¯¹è±¡
}
```

#### request å¯¹è±¡è¯¦è§£

| å±æ€§ | ç±»å‹ | å¯ä¿®æ”¹ | è¯´æ˜ |
|------|------|--------|------|
| `url` | string | âœ… | è¯·æ±‚çš„å®Œæ•´URL |
| `method` | string | âœ… | HTTPæ–¹æ³•ï¼šGET/POST/PUT/DELETE/PATCHç­‰ |
| `headers` | object | âœ… | è¯·æ±‚å¤´é”®å€¼å¯¹å¯¹è±¡ |
| `body` | string | âœ… | è¯·æ±‚ä½“å†…å®¹ |
| `bodyType` | string | âŒ | è¯·æ±‚ä½“ç±»å‹ï¼šnone/json/text/xml/form/formdata/binary |
| `settings` | object | âœ… | è¯·æ±‚é…ç½®ï¼štimeoutã€retry_countç­‰ |
| `variables` | object | âŒ | å½“å‰æ‰€æœ‰å¯ç”¨çš„å˜é‡ |
| `utils` | object | âŒ | å·¥å…·å‡½æ•°é›†ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ |

#### ä½¿ç”¨ç¤ºä¾‹

**ç¤ºä¾‹1ï¼šåŠ¨æ€æ·»åŠ æ—¶é—´æˆ³ç­¾å**

```javascript
function preRequest(request) {
    const timestamp = Date.now();
    const nonce = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
        const r = Math.random() * 16 | 0;
        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
    });
    
    // æ·»åŠ ç­¾åç›¸å…³è¯·æ±‚å¤´
    request.headers['X-Timestamp'] = timestamp;
    request.headers['X-Nonce'] = nonce;
    request.headers['X-Signature'] = 'your_sign_algorithm_here';
    
    request.utils.log('ç­¾åå·²ç”Ÿæˆ');
    return request;
}
```

**ç¤ºä¾‹2ï¼šåŠ¨æ€Tokenæ³¨å…¥**

```javascript
function preRequest(request) {
    // ä»å˜é‡ä¸­è·å–token
    const token = request.utils.getVariable('auth_token');
    
    if (token) {
        request.headers['Authorization'] = 'Bearer ' + token;
        request.utils.log('å·²æ³¨å…¥Token:', token.substring(0, 20) + '...');
    } else {
        request.utils.warn('æœªæ‰¾åˆ°auth_tokenå˜é‡ï¼Œè¯·å…ˆç™»å½•');
    }
    
    return request;
}
```

**ç¤ºä¾‹3ï¼šç¯å¢ƒåˆ‡æ¢**

```javascript
function preRequest(request) {
    const env = request.utils.getVariable('current_env') || 'dev';
    
    const baseUrls = {
        dev: 'http://localhost:8080',
        test: 'http://test.example.com',
        prod: 'https://api.example.com'
    };
    
    const baseUrl = baseUrls[env] || baseUrls.dev;
    
    // æ›¿æ¢URLä¸­çš„å ä½ç¬¦
    request.url = request.url.replace('{{base_url}}', baseUrl);
    request.utils.log('å½“å‰ç¯å¢ƒ:', env, 'BaseURL:', baseUrl);
    
    return request;
}
```

**ç¤ºä¾‹4ï¼šä¿®æ”¹è¯·æ±‚ä½“**

```javascript
function preRequest(request) {
    if (request.body && request.bodyType === 'json') {
        try {
            const body = JSON.parse(request.body);
            body.timestamp = Date.now();
            body.clientId = 'web-app';
            request.body = JSON.stringify(body);
            request.utils.log('è¯·æ±‚ä½“å·²ä¿®æ”¹');
        } catch (e) {
            request.utils.error('JSONè§£æå¤±è´¥:', e.message);
        }
    }
    return request;
}
```

---

### ğŸ“¤ Post-Response Hookï¼ˆåç½®è„šæœ¬ï¼‰

åç½®è„šæœ¬åœ¨å“åº”è¿”å›åæ‰§è¡Œï¼Œå¯ä»¥å¤„ç†å“åº”æ•°æ®ã€æå–å˜é‡ç­‰ã€‚

#### å‡½æ•°ç­¾å

```javascript
function postResponse(response) {
    // response åŒ…å«ä»¥ä¸‹å±æ€§ï¼š
    // - status: HTTPçŠ¶æ€ç ï¼ˆåªè¯»ï¼‰
    // - statusText: çŠ¶æ€æ–‡æœ¬ï¼ˆåªè¯»ï¼‰
    // - headers: å“åº”å¤´å¯¹è±¡ï¼ˆåªè¯»ï¼‰
    // - body: å“åº”ä½“å­—ç¬¦ä¸²ï¼ˆå¯ä¿®æ”¹æ˜¾ç¤ºå†…å®¹ï¼‰
    // - duration: å“åº”è€—æ—¶msï¼ˆåªè¯»ï¼‰
    // - contentType: å†…å®¹ç±»å‹ï¼ˆåªè¯»ï¼‰
    // - json: JSONè§£æåçš„å¯¹è±¡ï¼ˆåªè¯»ï¼Œä»…JSONå“åº”æ—¶å¯ç”¨ï¼‰
    // - utils: å·¥å…·å‡½æ•°é›†
    
    return response;  // å¿…é¡»è¿”å› response å¯¹è±¡
}
```

#### response å¯¹è±¡è¯¦è§£

| å±æ€§ | ç±»å‹ | å¯ä¿®æ”¹ | è¯´æ˜ |
|------|------|--------|------|
| `status` | number | âŒ | HTTPçŠ¶æ€ç ï¼š200ã€404ã€500ç­‰ |
| `statusText` | string | âŒ | çŠ¶æ€æ–‡æœ¬ï¼šOKã€Not Foundç­‰ |
| `headers` | object | âŒ | å“åº”å¤´é”®å€¼å¯¹å¯¹è±¡ |
| `body` | string | âœ… | å“åº”ä½“å†…å®¹ |
| `duration` | number | âŒ | å“åº”è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `contentType` | string | âŒ | Content-Typeå“åº”å¤´å€¼ |
| `json` | object | âŒ | JSONè§£æåçš„å¯¹è±¡ï¼ˆä»…å½“å“åº”æ˜¯JSONæ—¶ï¼‰ |
| `utils` | object | âŒ | å·¥å…·å‡½æ•°é›†ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ |

#### ä½¿ç”¨ç¤ºä¾‹

**ç¤ºä¾‹1ï¼šè‡ªåŠ¨æå–å¹¶ä¿å­˜Token**

```javascript
function postResponse(response) {
    const utils = response.utils;
    
    // æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ
    if (response.status === 200 && response.json) {
        // å°è¯•ä»ä¸åŒä½ç½®æå–token
        const token = response.json.token || 
                      response.json.data?.token ||
                      response.json.access_token ||
                      response.json.result?.accessToken;
        
        if (token) {
            utils.setVariable('auth_token', token);
            utils.success('Tokenå·²æå–å¹¶ä¿å­˜');
        }
    }
    
    // æ£€æµ‹tokenè¿‡æœŸ
    if (response.status === 401) {
        utils.warn('Tokenå¯èƒ½å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
        utils.setVariable('token_expired', 'true');
    }
    
    return response;
}
```

**ç¤ºä¾‹2ï¼šå“åº”æ—¥å¿—è®°å½•**

```javascript
function postResponse(response) {
    const utils = response.utils;
    
    utils.info('=== å“åº”ä¿¡æ¯ ===');
    utils.info('çŠ¶æ€ç :', response.status);
    utils.info('çŠ¶æ€æ–‡æœ¬:', response.statusText);
    utils.info('å“åº”è€—æ—¶:', response.duration, 'ms');
    utils.info('å†…å®¹ç±»å‹:', response.contentType);
    
    if (response.json) {
        utils.info('JSONæ•°æ®:', JSON.stringify(response.json, null, 2));
    } else if (response.body) {
        utils.info('å“åº”ä½“é•¿åº¦:', response.body.length, 'å­—ç¬¦');
    }
    
    return response;
}
```

**ç¤ºä¾‹3ï¼šè‡ªåŠ¨ä¿å­˜å“åº”å­—æ®µ**

```javascript
function postResponse(response) {
    const utils = response.utils;
    
    if (response.json && response.json.data) {
        const data = response.json.data;
        
        // è‡ªåŠ¨ä¿å­˜å¸¸ç”¨å­—æ®µåˆ°å˜é‡
        const fieldsToSave = ['id', 'userId', 'userName', 'email', 'roleId'];
        
        fieldsToSave.forEach(field => {
            if (data[field] !== undefined) {
                utils.setVariable('last_' + field, data[field]);
            }
        });
        
        utils.success('å·²è‡ªåŠ¨ä¿å­˜å“åº”å­—æ®µåˆ°å˜é‡');
    }
    
    return response;
}
```

**ç¤ºä¾‹4ï¼šé”™è¯¯å¤„ç†ä¸é‡è¯•æ ‡è®°**

```javascript
function postResponse(response) {
    const utils = response.utils;
    
    if (response.status >= 400) {
        utils.error('è¯·æ±‚å¤±è´¥:', response.status);
        
        // ä¿å­˜é”™è¯¯ä¿¡æ¯
        utils.setVariable('last_error_status', response.status);
        utils.setVariable('last_error_time', new Date().toISOString());
        
        if (response.json && response.json.message) {
            utils.error('é”™è¯¯ä¿¡æ¯:', response.json.message);
            utils.setVariable('last_error_msg', response.json.message);
        }
    } else {
        utils.success('è¯·æ±‚æˆåŠŸ');
        utils.setVariable('last_error_status', '');
    }
    
    return response;
}
```

---

### ğŸ› ï¸ å·¥å…·å‡½æ•°é›†ï¼ˆutilsï¼‰

Hook è„šæœ¬ä¸­å¯é€šè¿‡ `request.utils` æˆ– `response.utils` è®¿é—®å·¥å…·å‡½æ•°é›†ã€‚

#### æ—¥å¿—å‡½æ•°

| å‡½æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `log(...args)` | è¾“å‡ºæ™®é€šæ—¥å¿—ï¼ˆè“è‰²ï¼‰ | `utils.log('æ¶ˆæ¯')` |
| `info(...args)` | è¾“å‡ºä¿¡æ¯æ—¥å¿—ï¼ˆè“è‰²ï¼‰ | `utils.info('ä¿¡æ¯')` |
| `success(...args)` | è¾“å‡ºæˆåŠŸæ—¥å¿—ï¼ˆç»¿è‰²ï¼‰ | `utils.success('æˆåŠŸ!')` |
| `warn(...args)` | è¾“å‡ºè­¦å‘Šæ—¥å¿—ï¼ˆé»„è‰²ï¼‰ | `utils.warn('è­¦å‘Š')` |
| `error(...args)` | è¾“å‡ºé”™è¯¯æ—¥å¿—ï¼ˆçº¢è‰²ï¼‰ | `utils.error('é”™è¯¯')` |

#### å˜é‡æ“ä½œå‡½æ•°

| å‡½æ•° | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `setVariable(name, value)` | name: å˜é‡å, value: å˜é‡å€¼ | void | è®¾ç½®å˜é‡ï¼ˆè‡ªåŠ¨åˆ·æ–°å˜é‡è¡¨æ ¼ï¼‰ |
| `getVariable(name)` | name: å˜é‡å | string\|undefined | è·å–å˜é‡å€¼ï¼ˆä»…å¯ç”¨çš„å˜é‡ï¼‰ |
| `getAllVariables()` | æ—  | object | è·å–æ‰€æœ‰å¯ç”¨çš„å˜é‡ |

**å˜é‡æ“ä½œç¤ºä¾‹ï¼š**

```javascript
// è®¾ç½®å˜é‡
utils.setVariable('api_key', 'sk-xxx');
utils.setVariable('user_id', '12345');

// è·å–å˜é‡
const apiKey = utils.getVariable('api_key');
const userId = utils.getVariable('user_id');

// è·å–æ‰€æœ‰å˜é‡
const allVars = utils.getAllVariables();
// è¿”å›: { api_key: 'sk-xxx', user_id: '12345', ... }
```

#### å…¨å±€è¯·æ±‚å¤´æ“ä½œå‡½æ•°

| å‡½æ•° | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `setGlobalHeader(name, value)` | name: è¯·æ±‚å¤´å, value: è¯·æ±‚å¤´å€¼ | void | è®¾ç½®å…¨å±€è¯·æ±‚å¤´ï¼ˆè‡ªåŠ¨åˆ·æ–°è¯·æ±‚å¤´è¡¨æ ¼ï¼‰ |
| `getGlobalHeader(name)` | name: è¯·æ±‚å¤´å | string\|undefined | è·å–å…¨å±€è¯·æ±‚å¤´å€¼ï¼ˆä»…å¯ç”¨çš„ï¼‰ |
| `getAllGlobalHeaders()` | æ—  | object | è·å–æ‰€æœ‰å¯ç”¨çš„å…¨å±€è¯·æ±‚å¤´ |

**å…¨å±€è¯·æ±‚å¤´æ“ä½œç¤ºä¾‹ï¼š**

```javascript
// è®¾ç½®å…¨å±€è¯·æ±‚å¤´
utils.setGlobalHeader('Authorization', 'Bearer token_xxx');
utils.setGlobalHeader('X-API-Key', 'key_xxx');

// è·å–å…¨å±€è¯·æ±‚å¤´
const auth = utils.getGlobalHeader('Authorization');

// è·å–æ‰€æœ‰å…¨å±€è¯·æ±‚å¤´
const allHeaders = utils.getAllGlobalHeaders();
// è¿”å›: { Authorization: 'Bearer token_xxx', ... }
```

---

### ğŸ“ å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

#### åœºæ™¯1ï¼šOAuth2 è‡ªåŠ¨åŒ–è®¤è¯

```javascript
// === Pre-Request Hook ===
function preRequest(request) {
    const utils = request.utils;
    const token = utils.getVariable('oauth_token');
    const tokenExpire = utils.getVariable('token_expire_time');
    const now = Date.now();
    
    // æ£€æŸ¥tokenæ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ
    if (token && tokenExpire && now < parseInt(tokenExpire)) {
        request.headers['Authorization'] = 'Bearer ' + token;
        utils.log('ä½¿ç”¨ç¼“å­˜çš„Token');
    } else {
        utils.warn('Tokenä¸å­˜åœ¨æˆ–å·²è¿‡æœŸï¼Œéœ€è¦é‡æ–°è·å–');
        // å¯ä»¥è®¾ç½®æ ‡è®°ï¼Œè®©åç»­æµç¨‹å¤„ç†
        utils.setVariable('need_refresh_token', 'true');
    }
    
    return request;
}

// === Post-Response Hook ===
function postResponse(response) {
    const utils = response.utils;
    
    // å¦‚æœæ˜¯ç™»å½•æ¥å£ï¼Œè‡ªåŠ¨ä¿å­˜token
    if (response.json && response.json.access_token) {
        const token = response.json.access_token;
        const expiresIn = response.json.expires_in || 3600;
        
        utils.setVariable('oauth_token', token);
        utils.setVariable('token_expire_time', Date.now() + expiresIn * 1000);
        utils.success('Tokenå·²ä¿å­˜ï¼Œæœ‰æ•ˆæœŸ:', expiresIn, 'ç§’');
    }
    
    // å¦‚æœè¿”å›401ï¼Œæ¸…é™¤token
    if (response.status === 401) {
        utils.setVariable('oauth_token', '');
        utils.setVariable('token_expire_time', '');
        utils.warn('Tokenå·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•');
    }
    
    return response;
}
```

#### åœºæ™¯2ï¼šAPIç­¾åè®¤è¯

```javascript
// === Pre-Request Hook ===
function preRequest(request) {
    const utils = request.utils;
    
    // è·å–APIå¯†é’¥
    const appId = utils.getVariable('app_id') || 'your_app_id';
    const appSecret = utils.getVariable('app_secret') || 'your_app_secret';
    
    // ç”Ÿæˆç­¾åå‚æ•°
    const timestamp = Date.now().toString();
    const nonce = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
        const r = Math.random() * 16 | 0;
        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
    });
    
    // ç®€å•ç­¾åç¤ºä¾‹ï¼ˆå®é™…ä½¿ç”¨æ—¶å»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„ç®—æ³•ï¼‰
    const signStr = appId + timestamp + nonce + appSecret;
    
    // è®¾ç½®ç­¾åè¯·æ±‚å¤´
    request.headers['X-App-Id'] = appId;
    request.headers['X-Timestamp'] = timestamp;
    request.headers['X-Nonce'] = nonce;
    request.headers['X-Signature'] = signStr;  // å®é™…ä½¿ç”¨æ—¶åº”è¯¥ç”¨MD5/SHA256ç­‰
    
    utils.log('ç­¾åå‚æ•°å·²ç”Ÿæˆ');
    utils.log('AppId:', appId);
    utils.log('Timestamp:', timestamp);
    utils.log('Nonce:', nonce);
    
    return request;
}
```

#### åœºæ™¯3ï¼šæ¥å£æµ‹è¯•æ–­è¨€

```javascript
// === Post-Response Hook ===
function postResponse(response) {
    const utils = response.utils;
    let passCount = 0;
    let failCount = 0;
    
    // æ–­è¨€å‡½æ•°
    function assert(condition, message) {
        if (condition) {
            utils.success('âœ“ ' + message);
            passCount++;
        } else {
            utils.error('âœ— ' + message);
            failCount++;
        }
    }
    
    utils.info('===== å¼€å§‹æ–­è¨€æµ‹è¯• =====');
    
    // çŠ¶æ€ç æ–­è¨€
    assert(response.status === 200, `çŠ¶æ€ç åº”ä¸º200ï¼Œå®é™…ä¸º${response.status}`);
    
    // å“åº”æ—¶é—´æ–­è¨€
    assert(response.duration < 1000, `å“åº”æ—¶é—´åº”å°äº1000msï¼Œå®é™…ä¸º${response.duration}ms`);
    
    // JSONç»“æ„æ–­è¨€
    if (response.json) {
        assert(response.json.code !== undefined, 'å“åº”åº”åŒ…å«codeå­—æ®µ');
        assert(response.json.code === 0, `ä¸šåŠ¡ç åº”ä¸º0ï¼Œå®é™…ä¸º${response.json.code}`);
        assert(response.json.data !== undefined, 'å“åº”åº”åŒ…å«dataå­—æ®µ');
        
        // æ•°æ®å­—æ®µæ–­è¨€
        if (response.json.data) {
            assert(response.json.data.id !== undefined, 'dataåº”åŒ…å«idå­—æ®µ');
            assert(typeof response.json.data.id === 'string', 'idåº”ä¸ºå­—ç¬¦ä¸²ç±»å‹');
        }
    }
    
    utils.info('===== æ–­è¨€æµ‹è¯•å®Œæˆ =====');
    utils.info(`é€šè¿‡: ${passCount}, å¤±è´¥: ${failCount}`);
    
    // ä¿å­˜æµ‹è¯•ç»“æœ
    utils.setVariable('test_pass_count', passCount.toString());
    utils.setVariable('test_fail_count', failCount.toString());
    
    return response;
}
```

---

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–

Hook è„šæœ¬ä¼šéšæ¥å£ä¸€èµ·ä¿å­˜ï¼š

1. **å†å²è®°å½•**ï¼šå‘é€è¯·æ±‚åï¼ŒHook è„šæœ¬ä¼šä¿å­˜åˆ°å†å²è®°å½•ä¸­
2. **æ¥å£é›†åˆ**ï¼šä¿å­˜æ¥å£åˆ°é›†åˆæ—¶ï¼ŒHook è„šæœ¬ä¼šä¸€èµ·ä¿å­˜
3. **å¯¼å…¥å¯¼å‡º**ï¼šå¯¼å‡ºé…ç½®æ—¶ä¼šåŒ…å«æ‰€æœ‰ Hook è„šæœ¬

---

### âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¿…é¡»è¿”å›å¯¹è±¡**ï¼š`preRequest` å¿…é¡»è¿”å› `request`ï¼Œ`postResponse` å¿…é¡»è¿”å› `response`
2. **å¼‚æ­¥æ”¯æŒ**ï¼šè„šæœ¬æ”¯æŒ async/awaitï¼Œå¯ä»¥ä½¿ç”¨ Promise
3. **é”™è¯¯å¤„ç†**ï¼šè„šæœ¬æ‰§è¡Œå‡ºé”™ä¸ä¼šå½±å“è¯·æ±‚ï¼Œé”™è¯¯ä¿¡æ¯ä¼šæ˜¾ç¤ºåœ¨æ§åˆ¶å°
4. **å®‰å…¨é™åˆ¶**ï¼šè„šæœ¬åœ¨æµè§ˆå™¨æ²™ç®±ä¸­æ‰§è¡Œï¼Œæ— æ³•è®¿é—®æ•æ„Ÿ API
5. **å˜é‡ä½œç”¨åŸŸ**ï¼š`setVariable` è®¾ç½®çš„å˜é‡å¯åœ¨åç»­è¯·æ±‚ä¸­ä½¿ç”¨ `{{å˜é‡å}}` å¼•ç”¨

---
</br>

# Mock æœåŠ¡å™¨

**Mock** æ˜¯ä¸€ä¸ªåŸºäº Go çš„ API Mock æœåŠ¡ï¼šé€šè¿‡ä¸€ä»½ JSON é…ç½®å³å¯æä¾› REST æ¥å£ã€é™æ€èµ„æºã€WebSocketã€SSE ç­‰èƒ½åŠ›ï¼Œå¹¶æ”¯æŒè·¯å¾„å‚æ•°ã€æ¡ä»¶åŒ¹é…ã€æ¨¡æ¿å˜é‡ã€çƒ­é‡è½½ä¸å†…ç½® Admin æ§åˆ¶å°ã€‚


## é…ç½®æ–‡ä»¶é¡¶å±‚ç»“æ„ï¼ˆmock.jsonï¼‰

```jsonc
{
  "listen":     [ /* æœåŠ¡ç›‘å¬ï¼šhost/port/protocols/cert/key */ ],
  "static":     [ /* é™æ€ç›®å½•æŒ‚è½½ */ ],
  "routes":     [ /* HTTP API Mock */ ],
  "websockets": [ /* WebSocket å‰§æœ¬ */ ],
  "sse":        [ /* Server-Sent Events */ ]
}
```

- å„é¡¶å±‚å­—æ®µå‡å¯ä¸ºç©ºæ•°ç»„ã€‚
- æ¨èåœ¨ Admin ä¸­ç¼–è¾‘ï¼ˆå¸¦æ ¡éªŒä¸è¿è¡Œæ€åŒæ­¥ï¼‰ï¼Œä¹Ÿå¯æœ¬åœ°ç¼–è¾‘åé€šè¿‡ Reload æˆ–é‡å¯ç”Ÿæ•ˆã€‚
- JSON ä¸­æ•°å­—ä¼šè§£æä¸º `float64`ï¼Œä¹¦å†™å¸ƒå°”/æ•´å‹æ—¶æ³¨æ„ç±»å‹ã€‚

---

## ç›‘å¬æœåŠ¡ï¼ˆlistenï¼‰

ç”¨äºé…ç½® Mock æœåŠ¡ç›‘å¬çš„åœ°å€ä¸åè®®ã€‚

```json
{
  "listen": [
    {
      "host": "0.0.0.0",
      "port": 8080,
      "protocols": ["http", "https"],
      "cert_file": "./certs/mock.crt",
      "key_file": "./certs/mock.key"
    }
  ]
}
```

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `host` | ç›‘å¬åœ°å€ï¼š`localhost`ã€`127.0.0.1`ã€`::1`ã€åŸŸåæˆ–å†…ç½‘ IP |
| `port` | ç«¯å£ |
| `protocols` | å¯åŒæ—¶åŒ…å« `http` ä¸ `https`ï¼›æ¯ä¸ª listen é¡¹ä¼šå¯åŠ¨ä¸€ä¸ª Server |
| `cert_file` / `key_file` | HTTPS è¯ä¹¦ä¸ç§é’¥è·¯å¾„ï¼›å¯ç”¨ `https` æ—¶å¿…å¡«ï¼Œå¦åˆ™å¯åŠ¨ä¼šæŠ¥é”™ |

---

## é™æ€èµ„æºï¼ˆstaticï¼‰

å°† URL å‰ç¼€æ˜ å°„åˆ°æœ¬åœ°ç›®å½•ï¼Œç”¨äºæ‰˜ç®¡ Swaggerã€å›¾ç‰‡ã€é™„ä»¶ç­‰ã€‚

```json
{
  "static": [
    {
      "mount": "/assets/",
      "dir": "./public",
      "download": false,
      "index_files": ["index.html", "home.html"],
      "allow_methods": ["GET", "HEAD"],
      "headers": { "Cache-Control": "max-age=86400" }
    }
  ]
}
```

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `mount` | URL å‰ç¼€ï¼›ä¸ä»¥ `/` ç»“å°¾æ—¶ä¼šè‡ªåŠ¨è¡¥å°¾æ–œæ å¹¶åš 301 é‡å®šå‘ |
| `dir` | æœ¬åœ°ç›®å½•ï¼›è¯·æ±‚ `/assets/app.js` å¯¹åº” `./public/app.js` |
| `download` | `true` æ—¶æ‰€æœ‰å“åº”å¸¦ `Content-Disposition: attachment` |
| `index_files` | ç›®å½•é»˜è®¤é¦–é¡µçš„æŸ¥æ‰¾é¡ºåºï¼ˆå¯é€‰ï¼‰ |
| `allow_methods` | å…è®¸çš„ HTTP æ–¹æ³•ï¼Œå¦‚åªå…è®¸ GET/HEADï¼›æœªé…ç½®åˆ™ä¸é™åˆ¶æ–¹æ³• |
| `headers` | å¯¹é™æ€å“åº”ç»Ÿä¸€æ·»åŠ çš„å¤´éƒ¨ |

---

## HTTP è·¯ç”±ï¼ˆroutesï¼‰

### æœ€å°ç¤ºä¾‹

```json
{
  "method": "GET",
  "path": "/api/user/{id}",
  "responses": [
    { "status": 200, "body": { "id": "{{param.id}}", "ok": true } }
  ]
}
```

è®¿é—® `GET /api/user/42` å¾—åˆ°ï¼š`{ "id": "42", "ok": true }`ã€‚

### æ–¹æ³•ã€è·¯å¾„ä¸ ANY

- `method`ï¼š`GET`ã€`POST`ã€`PUT`ã€`PATCH`ã€`DELETE` ç­‰ï¼›é…ç½®ä¼šè½¬ä¸ºå¤§å†™åŒ¹é…ã€‚
- `method: "ANY"` æˆ–ç©ºå­—ç¬¦ä¸²ï¼šä¸é™åˆ¶ HTTP æ–¹æ³•ã€‚
- `path`ï¼šæ”¯æŒ gorilla/mux è·¯å¾„ï¼Œå¦‚ `/api/user/{id}/info/{section}`ï¼Œ`{id}` ç­‰ä¼šæ³¨å…¥ä¸º `param.id`ã€`param.section`ã€‚

### è¯·æ±‚åŒ¹é…ï¼ˆmatchï¼‰

åœ¨è¿›å…¥å“åº”åˆ†æ”¯å‰ï¼Œå¯è¦æ±‚ **headers / query / body** åŒæ—¶æ»¡è¶³æ¡ä»¶ï¼›æœªé…ç½® `match` åˆ™è§†ä¸ºé€šè¿‡ã€‚

```json
"match": {
  "headers": { "x-token": "^test-" },
  "query":   { "env": "^(dev|qa)$" },
  "body":    { "meta.version": "^v\\d+$", "items.0.type": "vip" }
}
```

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| `headers` / `query` | å€¼ä¸º**æ­£åˆ™**ï¼›è‹¥åªåšç­‰å€¼ï¼Œå»ºè®®å†™ `^value$` |
| `body` | é”®ä¸ºç‚¹è·¯å¾„æˆ–å¸¦ç´¢å¼•è·¯å¾„ï¼š`foo.bar`ã€`items.0.id` æˆ– `items[0].id`ï¼›å€¼å¯ä¸ºæ­£åˆ™æˆ–ç­‰å€¼ï¼ˆéå­—ç¬¦ä¸²ä¼šè½¬æˆå­—ç¬¦ä¸²æ¯”è¾ƒï¼‰ |

å…¨éƒ¨æ»¡è¶³æ‰å‘½ä¸­è¯¥ routeï¼›å¦åˆ™è¿”å› 404ã€‚

### è·¯ç”±çº§æ¡ä»¶ï¼ˆwhenï¼‰

åœ¨ route ä¸Šå¯é…ç½® `when`ï¼Œä¸å“åº”åˆ†æ”¯çš„ when åŒè¯­ä¹‰ï¼šä¸é€šè¿‡åˆ™è¿”å› 403ã€‚

```json
"when": {
  "query.age": ">18",
  "header.X-Role": "~^admin|root$"
}
```

when çš„ value æ”¯æŒç­‰å€¼æˆ–æ“ä½œç¬¦å‰ç¼€ï¼š`=`ã€`!=`ã€`>`ã€`<`ã€`~`ï¼ˆæ­£åˆ™ï¼‰ã€`contains`ï¼ˆå­—ç¬¦ä¸²åŒ…å«ï¼‰ã€‚

### å˜é‡æå–ï¼ˆextractï¼‰

ä»è¯·æ±‚ body/query/header ä¸­æŒ‰ã€Œç‚¹è·¯å¾„ã€æå–å­—æ®µï¼Œæ³¨å…¥ä¸º `extract.<key>`ï¼Œä¾›å“åº”/æ¨¡æ¿ä½¿ç”¨ã€‚

```json
"extract": {
  "from": "body",
  "rules": {
    "customerId": "customer.id",
    "ip": "X-Real-IP"
  }
}
```

- `from`ï¼š`body`ã€`query`ã€`header` ä¹‹ä¸€ã€‚
- `rules`ï¼šé”®ä¸ºå˜é‡åï¼Œå€¼ä¸º**ç‚¹è·¯å¾„**ï¼ˆå¦‚ `customer.id`ã€`root.users.0.info.data`ï¼‰ï¼Œ**ä¸è¦**ä½¿ç”¨ `$.` å‰ç¼€ã€‚
- æå–ç»“æœåœ¨æ¨¡æ¿ä¸­ä»¥ `{{extract.customerId}}`ã€`{{extract.ip}}` ä½¿ç”¨ã€‚

### å˜é‡å‘½åç©ºé—´

ä»¥ä¸‹å˜é‡å¯åœ¨ `when`ã€`headers`ã€`cookies`ã€`body`ã€`file`ã€`template` ä¸­ä½¿ç”¨ã€‚

| å‘½åç©ºé—´ | æ¥æº | è¯´æ˜ |
|----------|------|------|
| `param.xxx` | è·¯å¾„å‚æ•° `/foo/{id}` | mux è‡ªåŠ¨æ³¨å…¥ |
| `query.xxx` | URL æŸ¥è¯¢å‚æ•° | å¤šå€¼å–ç¬¬ä¸€ä¸ª |
| `header.xxx` | è¯·æ±‚å¤´ | ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼ˆå¤§å°å†™ï¼‰ |
| `body.xxx` | JSON è¯·æ±‚ä½“é¡¶å±‚å­—æ®µ | åµŒå¥—éœ€é€šè¿‡ extract æˆ– match.body ç‚¹è·¯å¾„ |
| `form.xxx` | è¡¨å•å­—æ®µ | `multipart/form-data`ã€`application/x-www-form-urlencoded` |
| `form.xxx.filename` / `form.xxx.size` | ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯ | ä»… multipart æ—¶å¯ç”¨ |
| `extract.xxx` | extract è§„åˆ™ç»“æœ | æ¥è‡ª `extract.rules` |

å¼•ç”¨æ—¶å»ºè®®å¸¦å‘½åç©ºé—´ï¼Œå¦‚ `{{param.id}}`ã€`{{query.env}}`ã€`{{body.name}}`ã€`{{extract.customerId}}`ã€‚

### å†…ç½®å‡½æ•°æ¨¡æ¿ï¼ˆfuncï¼‰

é™¤äº†ä»è¯·æ±‚ä¸­æå–å˜é‡ï¼Œè¿˜æ”¯æŒåœ¨æ¨¡æ¿ä¸­è°ƒç”¨å†…ç½®å‡½æ•°ï¼ŒåŠ¨æ€ç”Ÿæˆå€¼ã€‚è¯­æ³•ä¸º `{{func.å‡½æ•°å()}}` æˆ– `{{func.å‡½æ•°å(å‚æ•°)}}`ã€‚

#### æ”¯æŒçš„å‡½æ•°åˆ—è¡¨

| å‡½æ•° | ç”¨æ³• | è¯´æ˜ |
|------|------|------|
| `uuid` | `{{func.uuid()}}` | ç”Ÿæˆ UUID v4 å­—ç¬¦ä¸² |
| `timestamp` | `{{func.timestamp()}}` | è·å–å½“å‰æ—¶é—´æˆ³ï¼ˆç§’ï¼‰ |
| `timestamp_sec` | `{{func.timestamp_sec()}}` | è·å–å½“å‰æ—¶é—´æˆ³ï¼ˆç§’ï¼‰ |
| `timestamp_ms` | `{{func.timestamp_ms()}}` | è·å–å½“å‰æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ |
| `now` | `{{func.now()}}` | è·å–å½“å‰æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ `2006-01-02 15:04:05` |
| `now` | `{{func.now(2006-01-02)}}` | è·å–å½“å‰æ—¶é—´ï¼Œè‡ªå®šä¹‰æ ¼å¼ |
| `date` | `{{func.date()}}` | è·å–å½“å‰æ—¥æœŸï¼Œé»˜è®¤æ ¼å¼ `2006-01-02` |
| `date` | `{{func.date(01/02/2006)}}` | è·å–å½“å‰æ—¥æœŸï¼Œè‡ªå®šä¹‰æ ¼å¼ |
| `time` | `{{func.time()}}` | è·å–å½“å‰æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ `15:04:05` |
| `time` | `{{func.time(15:04)}}` | è·å–å½“å‰æ—¶é—´ï¼Œè‡ªå®šä¹‰æ ¼å¼ |
| `random_int` | `{{func.random_int()}}` | ç”Ÿæˆéšæœºæ•´æ•°ï¼Œé»˜è®¤èŒƒå›´ 0-1000 |
| `random_int` | `{{func.random_int(1, 100)}}` | ç”Ÿæˆéšæœºæ•´æ•°ï¼ŒæŒ‡å®šèŒƒå›´ |
| `random_string` | `{{func.random_string()}}` | ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼Œé»˜è®¤é•¿åº¦ 16 |
| `random_string` | `{{func.random_string(32)}}` | ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šé•¿åº¦ |

#### ä½¿ç”¨ç¤ºä¾‹

```json
{
  "path": "/api/order/create",
  "method": "POST",
  "responses": [
    {
      "status": 200,
      "headers": {
        "Content-Type": "application/json",
        "X-Request-Id": "{{func.uuid()}}"
      },
      "body": {
        "code": 0,
        "message": "success",
        "data": {
          "orderId": "{{func.uuid()}}",
          "orderNo": "ORD{{func.timestamp()}}",
          "createdAt": "{{func.now(2006-01-02 15:04:05)}}",
          "timestamp": {{func.timestamp()}},
          "token": "{{func.random_string(32)}}",
          "luckyNumber": {{func.random_int(1, 100)}}
        }
      }
    }
  ]
}
```

#### æ—¶é—´æ ¼å¼è¯´æ˜

Go è¯­è¨€çš„æ—¶é—´æ ¼å¼ä½¿ç”¨ç‰¹å®šçš„å‚è€ƒæ—¶é—´ `2006-01-02 15:04:05`ï¼Œå¸¸ç”¨æ ¼å¼ï¼š

| æ ¼å¼å­—ç¬¦ä¸² | è¾“å‡ºç¤ºä¾‹ |
|-----------|---------|
| `2006-01-02` | 2024-01-15 |
| `15:04:05` | 14:30:45 |
| `2006-01-02 15:04:05` | 2024-01-15 14:30:45 |
| `2006/01/02` | 2024/01/15 |
| `01/02/2006` | 01/15/2024 |
| `20060102150405` | 20240115143045 |

### å¤šå“åº”åˆ†æ”¯ï¼ˆwhenï¼‰

`responses` ä¸ºæ•°ç»„æ—¶ï¼ŒæŒ‰**é¡ºåº**åŒ¹é…ï¼šæ¯æ¡ response çš„ `when` å…¨æ»¡è¶³åˆ™é€‰ä¸­å¹¶è¿”å›ï¼›éƒ½ä¸æ»¡è¶³åˆ™ä½¿ç”¨ç¬¬ä¸€æ¡ã€‚

```json
"responses": [
  {
    "when": { "param.id": "007" },
    "status": 200,
    "body": { "msg": "for james bond" }
  },
  {
    "when": { "query.age": ">18" },
    "headers": { "X-Adult": "true" },
    "body": { "ok": true }
  },
  {
    "status": 404,
    "body": { "error": "not found" }
  }
]
```

- **when**ï¼šæ”¯æŒ `param.*`ã€`query.*`ã€`header.*`ã€`body.*`ã€`extract.*`ã€`form.*`ï¼›å¤šé”®éœ€å…¨éƒ¨æ»¡è¶³ã€‚
- **value å†™æ³•**ï¼š  
  - ç­‰å€¼ï¼š`"param.id": "007"`ï¼›  
  - è¡¨è¾¾å¼ï¼ˆæ“ä½œç¬¦å‰ç¼€ï¼‰ï¼š`"query.age": ">18"`ã€`"header.X-Role": "~^admin|root$"`ã€`"body.name": "contains:alice"`ã€‚  
  æ”¯æŒæ“ä½œç¬¦ï¼š`=`ã€`!=`ã€`>`ã€`<`ã€`~`ï¼ˆæ­£åˆ™ï¼‰ã€`contains`ã€‚
- è‹¥æ‰€æœ‰åˆ†æ”¯éƒ½ä¸æ»¡è¶³ï¼Œå®ç°ä¸Šä¼šå›é€€åˆ°ç¬¬ä¸€æ¡ responseï¼Œå› æ­¤å»ºè®®æœ€åä¸€æ¡å†™å…œåº•ã€‚

### å“åº”å­—æ®µè¯´æ˜

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `status` | HTTP çŠ¶æ€ç ï¼›å¯çœç•¥ï¼Œé»˜è®¤ 200 |
| `headers` | ä»»æ„å“åº”å¤´ï¼›å€¼æ”¯æŒæ¨¡æ¿å˜é‡ |
| `cookies` | Cookie æ•°ç»„ï¼Œè§ä¸‹è¡¨ï¼›ä¼šåšæ¨¡æ¿æ›¿æ¢ |
| `delay_ms` | å»¶è¿Ÿè‹¥å¹²æ¯«ç§’å†è¿”å›ï¼Œç”¨äºæ¨¡æ‹Ÿæ…¢æ¥å£ |
| `body` | å­—ç¬¦ä¸²æˆ–å¯¹è±¡ï¼›é€’å½’æ›¿æ¢æ¨¡æ¿å˜é‡åè¾“å‡º |
| `file` | æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆå¯å«å˜é‡ï¼‰ï¼›ç›´æ¥å°†è¯¥æ–‡ä»¶ä½œä¸ºå“åº”ä½“ |
| `template` | æ¨¡æ¿æ–‡ä»¶åï¼ˆæ— éœ€å†™ `@`ï¼‰ï¼›è¯»å–æ–‡ä»¶å†…å®¹ååšå˜é‡æ›¿æ¢å†è¿”å› |

**Cookie é…ç½®**ï¼ˆä¸‹åˆ’çº¿å‘½åï¼‰ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `name` / `value` | string | åç§°ä¸å€¼ |
| `path` / `domain` | string | å¯é€‰ |
| `expires` | string | å»ºè®® RFC3339 |
| `max_age` | int | ç§’ |
| `secure` / `http_only` | bool | ä»… HTTPS / ä¸å¯è¢« JS è¯»å– |
| `same_site` | string | `lax` / `strict` / `none` |

### å¼ºç±»å‹æ¨¡æ¿å ä½ç¬¦ï¼ˆint / float / boolï¼‰

é»˜è®¤ `{{key}}` æ›¿æ¢ä¸ºå­—ç¬¦ä¸²ã€‚è‹¥è¦åœ¨ JSON ä¸­è¾“å‡º**æ•°å­—**æˆ–**å¸ƒå°”**ï¼Œå¯ä½¿ç”¨ï¼š

- `{{@int:key}}` â†’ æ•´å‹ï¼ˆint64ï¼‰
- `{{@float:key}}` â†’ æµ®ç‚¹ï¼ˆfloat64ï¼‰
- `{{@bool:key}}` â†’ å¸ƒå°”

è§„åˆ™ï¼š

- è‹¥**æ•´ä¸²**ä»…ä¸ºä¸€ä¸ªå¼ºç±»å‹å ä½ç¬¦ï¼ˆå¦‚ `"{{@int:query.age}}"`ï¼‰ï¼Œåˆ™è¯¥å­—æ®µåœ¨ JSON ä¸­ä¸ºå¯¹åº”ç±»å‹ï¼ˆå¦‚ `123`ã€`true`ï¼‰ã€‚
- è‹¥ä¸å…¶å®ƒæ–‡å­—æ··ç”¨ï¼ˆå¦‚ `"age={{@int:query.age}}"`ï¼‰ï¼Œåˆ™æŒ‰å­—ç¬¦ä¸²æ›¿æ¢ï¼ˆå¦‚ `"age=77"`ï¼‰ã€‚
- è§£æå¤±è´¥æ—¶é€€åŒ–ä¸ºæ™®é€šå­—ç¬¦ä¸²æ›¿æ¢ã€‚

### æ¨¡æ¿æ–‡ä»¶ï¼ˆ@filenameï¼‰

å½“ `body` æˆ– `template` çš„å€¼ä¸ºä»¥ `@` å¼€å¤´çš„è·¯å¾„æ—¶ï¼Œç³»ç»Ÿä¼šè¯»å–è¯¥æ–‡ä»¶å¹¶åš `{{ }}` æ›¿æ¢åè¿”å›ã€‚

- ç¤ºä¾‹ï¼š`"body": "@payloads/small.json"`ï¼Œæ–‡ä»¶å†…å®¹å¯ä¸º JSON/XML/æ–‡æœ¬ã€‚
- è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå“åº”ä¸º `"template file not found"`ã€‚

### 7.11 è¡¨å•ä¸æ–‡ä»¶ä¸Šä¼ 

- å¯¹ `multipart/form-data` ä¸ `application/x-www-form-urlencoded` ä¼šè‡ªåŠ¨è§£æå¹¶æ³¨å…¥ `form.xxx`ã€‚
- ä¸Šä¼ æ–‡ä»¶ä¼šé¢å¤–æä¾› `form.<field>.filename`ã€`form.<field>.size`ã€‚
- å¯åœ¨å“åº”æˆ–æ¨¡æ¿ä¸­å¼•ç”¨è¿™äº›å˜é‡ã€‚multipart è§£æå¤§å°å— `-max-multipart` é™åˆ¶ã€‚

---

## WebSocket Mock

åŸºäº gorilla/websocketï¼Œè·¯å¾„ä¸ mux ä¸€è‡´ï¼Œæ”¯æŒè·¯å¾„å‚æ•°ä¸æ¨¡æ¿å˜é‡ã€‚

```json
{
  "websockets": [
    {
      "path": "/ws/{room}",
      "match": {
        "query": { "token": ".+" },
        "headers": { "Sec-WebSocket-Protocol": "^chat$" }
      },
      "script": [
        { "send": "{\"type\":\"welcome\",\"room\":\"{{param.room}}\"}" },
        { "await": { "type": "auth" }, "timeout_ms": 5000 },
        { "send": "{\"type\":\"ok\"}" },
        { "delay_ms": 1000, "send": "{\"type\":\"broadcast\"}" },
        { "close": true }
      ]
    }
  ]
}
```

| é¡¹ | è¯´æ˜ |
|----|------|
| `path` | ä¸ HTTP è·¯ç”±ç›¸åŒï¼Œå¯å« `{param}` |
| `match` | å»ºç«‹è¿æ¥å‰æ ¡éªŒ headers/queryï¼ˆæ”¯æŒæ­£åˆ™ï¼‰ï¼›ä¸æ»¡è¶³åˆ™ 404 |
| `script` | æŒ‰é¡ºåºæ‰§è¡Œçš„åŠ¨ä½œåºåˆ— |

**script åŠ¨ä½œ**ï¼š

| é”® | è¯´æ˜ |
|----|------|
| `send` | å‘é€ä¸€æ¡æ–‡æœ¬æ¶ˆæ¯ï¼ˆå¯ JSON å­—ç¬¦ä¸²ï¼‰ï¼›æ”¯æŒæ¨¡æ¿å˜é‡ |
| `await` | é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯ä¸€æ¡æ¶ˆæ¯ï¼šå€¼ä¸º**å­—ç¬¦ä¸²**æ—¶æŒ‰æ­£åˆ™åŒ¹é…æ•´æ¡æ–‡æœ¬ï¼›å€¼ä¸º**å¯¹è±¡**æ—¶æŒ‰ JSON å­—æ®µç­‰å€¼åŒ¹é… |
| `timeout_ms` | ä¸ `await` é…åˆï¼Œè¶…æ—¶åå‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯å¹¶ç»“æŸ |
| `delay_ms` | æœ¬åŠ¨ä½œæ‰§è¡Œå‰å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| `close` | ä¸º `true` æ—¶å‘é€æ­£å¸¸å…³é—­å¸§å¹¶ç»“æŸè„šæœ¬ |

---

## Server-Sent Eventsï¼ˆSSEï¼‰

```json
{
  "sse": [
    {
      "path": "/sse/{topic}",
      "method": "GET",
      "match": { "query": { "client": ".+" } },
      "headers": { "X-Topic": "{{param.topic}}" },
      "status": 200,
      "cookies": [],
      "events": [
        { "id": "1", "event": "hello", "data": "topic={{param.topic}}", "retry": 1500 },
        { "event": "keepalive", "data": "ping", "delay_ms": 2000 },
        { "data": "done" }
      ],
      "repeat": false
    }
  ]
}
```

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `path` | è·¯å¾„ï¼Œå¯å«è·¯å¾„å‚æ•° |
| `method` | é»˜è®¤ `GET`ï¼Œä¹Ÿå¯ `POST` ç­‰ |
| `match` | åŒ routeï¼šheaders/query/body å…¨éƒ¨æ»¡è¶³æ‰å»ºç«‹æµ |
| `headers` / `cookies` / `status` | å¯é€‰ï¼›æ”¯æŒæ¨¡æ¿å˜é‡ |
| `events` | äº‹ä»¶åˆ—è¡¨ï¼›æ¯æ¡å¯å« `id`ã€`event`ã€`data`ã€`retry`ã€`delay_ms`ï¼›`data` æ”¯æŒæ¨¡æ¿ |
| `repeat` | `true` æ—¶ events å‘é€å®Œåä»å¤´å¾ªç¯ |

---

## æ¨¡æ¿å˜é‡ä¸ç”Ÿå‘½å‘¨æœŸ

å˜é‡æ³¨å…¥é¡ºåºï¼ˆä¸ä»£ç ä¸€è‡´ï¼‰ï¼š

1. è·¯å¾„å‚æ•° â†’ `param.*`
2. Query â†’ `query.*`ï¼ŒHeader â†’ `header.*`
3. è‹¥æ–¹æ³•å…è®¸ bodyï¼Œè¯»å– JSON â†’ `body.*`
4. è‹¥ä¸ºè¡¨å•/ä¸Šä¼  â†’ `form.*`ã€`form.*.filename`ã€`form.*.size`
5. æŒ‰ `extract` è§„åˆ™ â†’ `extract.*`

åŒä¸€è¯·æ±‚ä¸­ï¼Œ`when`ã€`headers`ã€`cookies`ã€`body`ã€`file`ã€`template` å…±ç”¨è¿™ä¸€å¥—å˜é‡è¡¨ã€‚

---

## ç®¡ç†æ§åˆ¶å°ï¼ˆAdmin UIï¼‰

- **åœ°å€**ï¼š`http://127.0.0.1:4444/mock/`
- **åŠŸèƒ½**ï¼š
  - **æ‹‰å–é…ç½®**ï¼šGET å½“å‰ `mock.json` å†…å®¹åŠæœåŠ¡æ˜¯å¦è¿è¡Œ
  - **Reload**ï¼šPOST æ–°é…ç½®ï¼ˆJSON å­—ç¬¦ä¸²ï¼‰ï¼Œå†™å…¥æ–‡ä»¶å¹¶çƒ­é‡å¯ Mock æœåŠ¡
  - **Start / Stop / Restart**ï¼šæ§åˆ¶ Mock æœåŠ¡è¿›ç¨‹ï¼ˆAdmin è‡ªèº«å¸¸é©»ï¼Œä¸éš Mock åœæ­¢ï¼‰

**API**ï¼š

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/mock/api/config` | è¿”å› `{ "config": "<JSON å­—ç¬¦ä¸²>", "running": bool }` |
| POST | `/mock/api/reload` | Bodyï¼š`{ "config": "<å®Œæ•´ JSON å­—ç¬¦ä¸²>" }`ï¼Œå†™å…¥å¹¶é‡å¯ |
| POST | `/mock/api/start` / `stop` / `restart` | å¯åœ/é‡å¯ Mock æœåŠ¡ |

æ¨èæµç¨‹ï¼šæ‹‰å–é…ç½® â†’ ç¼–è¾‘/æ ¼å¼åŒ– â†’ Reload â†’ æ ¹æ®è¿”å›ä¸æ—¥å¿—ç¡®è®¤æ˜¯å¦ `ok`ã€‚

---

## åŒ¹é…ä¸åˆ†æµç»†åˆ™

- **è·¯ç”±**ï¼šgorilla/mux é€æ¡æ³¨å†Œï¼Œè·¯å¾„å‚æ•° `{id}` ç­‰è‡ªåŠ¨æ³¨å…¥ `param.*`ã€‚
- **matchï¼ˆé¢„è¿‡æ»¤ï¼‰**ï¼š
  - `match.headers` / `match.query`ï¼šå€¼æŒ‰**æ­£åˆ™**åŒ¹é…ï¼›ç­‰å€¼è¯·å†™ `^value$`ã€‚
  - `match.body`ï¼šé”®ä¸ºç‚¹è·¯å¾„ï¼ˆå«æ•°ç»„ç´¢å¼•ï¼‰ï¼›å€¼è‹¥ä¸ºå­—ç¬¦ä¸²åˆ™æŒ‰æ­£åˆ™ï¼Œå¦åˆ™æŒ‰å­—ç¬¦ä¸²åŒ–åç­‰å€¼ï¼›å…¨éƒ¨æ»¡è¶³æ‰å‘½ä¸­ï¼Œå¦åˆ™ 404ã€‚
- **whenï¼ˆåˆ†æ”¯/è·¯ç”±çº§æ¡ä»¶ï¼‰**ï¼šæ”¯æŒ `param.*`ã€`query.*`ã€`header.*`ã€`body.*`ã€`extract.*`ã€`form.*`ï¼›å¤šé”®å…¨éƒ¨æ»¡è¶³æ‰é€šè¿‡ã€‚value å¯ä¸ºç­‰å€¼æˆ–å¸¦æ“ä½œç¬¦å‰ç¼€ï¼š`=`ã€`!=`ã€`>`ã€`<`ã€`~`ï¼ˆæ­£åˆ™ï¼‰ã€`contains`ï¼›æ¯”è¾ƒå‰ä¼šå°è¯•æ•°å€¼è§£æï¼ˆ>ã€<ï¼‰ã€‚
- **extract**ï¼šä»…æ”¯æŒç‚¹è·¯å¾„ï¼ˆå¦‚ `customer.id`ã€`root.users.0.info`ï¼‰ï¼Œä¸æ”¯æŒ `$.` å‰ç¼€ï¼›ç»“æœé€šè¿‡ `{{extract.<key>}}` ä½¿ç”¨ã€‚
- **æ¨¡æ¿æ›¿æ¢èŒƒå›´**ï¼š`body`ã€`headers`ã€`cookies` å„å­—æ®µåŠ `@æ¨¡æ¿æ–‡ä»¶` å†…å®¹å‡ä¼šæ›¿æ¢ã€‚

---

## è¿è¡Œæ—¶è¡Œä¸ºä¸æ—¥å¿—

- å¯åŠ¨æ—¶ä¼šæŒ‰æ¡è¾“å‡º `Register route: <METHOD> <PATH>`ï¼Œä¾¿äºç¡®è®¤è·¯ç”±åŠ è½½ã€‚
- è¯·æ±‚ä¼šæ‰“å°è·¯å¾„å‚æ•°æ³¨å…¥ç»“æœï¼ˆå¦‚ `DEBUG param injection`ï¼‰ï¼Œä¾¿äºæ’æŸ¥æ¨¡æ¿æœªæ›¿æ¢é—®é¢˜ã€‚
- é™æ€/WebSocket/SSE æ³¨å†Œã€HTTPS è¯ä¹¦é”™è¯¯ã€Reload å¤±è´¥ç­‰ä¼šåœ¨æ—¥å¿—ä¸­è¾“å‡ºã€‚
- é•¿æœŸè¿è¡Œå»ºè®®é…åˆ supervisorã€systemd æˆ– Docker åšè¿›ç¨‹å®ˆæŠ¤ã€‚

---

## Mockå¸¸è§é—®é¢˜æ’æŸ¥

| ç°è±¡ | å¯èƒ½åŸå› ä¸å¤„ç† |
|------|----------------|
| å‘½ä¸­ä¸åˆ°è·¯ç”± | æ£€æŸ¥ method æ˜¯å¦ä¸é…ç½®ä¸€è‡´ï¼ˆé…ç½®ä¼šè½¬å¤§å†™ï¼‰ï¼›`match.headers`/query æ­£åˆ™æ˜¯å¦è¿‡ä¸¥æˆ–å¤§å°å†™ä¸ä¸€è‡´ |
| æ¨¡æ¿æ²¡æ›¿æ¢ | ç¡®è®¤ä½¿ç”¨ `{{param.id}}` ç­‰å¸¦å‘½åç©ºé—´å†™æ³•ï¼›ç¡®è®¤è¯·æ±‚ä¸­ç¡®å®å¸¦å¯¹åº” query/header/bodyï¼›çœ‹æ—¥å¿—ä¸­çš„ `vars` è¾“å‡º |
| when ä¸ç”Ÿæ•ˆ | when çš„ value æ”¯æŒç­‰å€¼æˆ–æ“ä½œç¬¦å‰ç¼€ï¼ˆ`>`ã€`<`ã€`~`ã€`contains`ï¼‰ï¼›ç¡®ä¿ body/form/extract å·²æ³¨å…¥ï¼ˆæ­£å¸¸ HTTP å·²å†…ç½®ï¼‰ |
| è¿”å›æ–‡ä»¶ 404 | `responses[].file` ä¸ºç›¸å¯¹è·¯å¾„æ—¶ç›¸å¯¹è¿›ç¨‹å·¥ä½œç›®å½•ï¼›å¯æ”¹ä¸ºä¸ `mock.json` åŒç›®å½•æˆ–ç»å¯¹è·¯å¾„ï¼›Windows æ³¨æ„åæ–œæ  |
| WebSocket await è¶…æ—¶ | ç¡®è®¤å®¢æˆ·ç«¯æŒ‰ script é¡ºåºå‘æ¶ˆæ¯ï¼›å¯å¢å¤§ `timeout_ms`ï¼›æŸ¥çœ‹æ—¥å¿—ä¸­çš„ upgrade/await ç›¸å…³è¾“å‡º |
| CORS é¢„æ£€ | æœåŠ¡å¯¹ OPTIONS åšäº†å…œåº•ï¼Œè¿”å›å¸¸ç”¨ CORS å¤´ï¼›å¦‚éœ€å®šåˆ¶å¯åœ¨å“åº” `headers` æˆ–é™æ€ headers ä¸­è¡¥å…… |


---

## ğŸ” é¡¹ç›®å¸¸è§é—®é¢˜

### â“ ä¸ºä»€ä¹ˆéœ€è¦åç«¯è½¬å‘ï¼Ÿ
> ç”±äºæµè§ˆå™¨åŒæºç­–ç•¥ï¼Œå‰ç«¯ç›´æ¥è¯·æ±‚ç¬¬ä¸‰æ–¹æ¥å£ä¼šé‡åˆ° CORS é™åˆ¶ã€‚é€šè¿‡æœ¬å·¥å…·çš„åç«¯è½¬å‘ï¼Œå‰ç«¯åªéœ€è¯·æ±‚æœ¬åœ°æœåŠ¡å³å¯ï¼Œåç«¯å†ä»£ä¸ºè¯·æ±‚ç›®æ ‡æ¥å£ï¼Œç»•è¿‡è·¨åŸŸé™åˆ¶ã€‚

### â“ WebCurlå˜é‡å¦‚ä½•ä½¿ç”¨,å˜é‡æ›¿æ¢æ”¯æŒä½ç½®ï¼Ÿ
> æ”¯æŒè¯·æ±‚url,è¯·æ±‚å¤´,å…¨å±€å¤´æ›¿æ¢ï¼Œä½¿ç”¨{{xxx}}å¼•ç”¨å®šä¹‰çš„å˜é‡ã€‚

### â“ å¦‚ä½•ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Ÿ
> åœ¨å‰ç«¯é€‰æ‹© `form-data`ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯å•ç‹¬é€‰æ‹©ï¼Œæ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ ã€‚åç«¯ä¼šè‡ªåŠ¨å¤„ç†ã€‚

### â“ å¦‚ä½•ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Ÿ
> å¯åŠ¨æ—¶é€šè¿‡ `--upload-dir=/your/path` å‚æ•°æŒ‡å®šç›®å½•ï¼Œform-dataä¸Šä¼ çš„æ–‡ä»¶ä¼šè‡ªåŠ¨ä¿å­˜åˆ°è¯¥ç›®å½•ï¼ˆå­˜åœ¨åˆ™è¦†ç›–ï¼‰ã€‚ç›®å½•éœ€æå‰åˆ›å»ºå¹¶æœ‰å†™æƒé™ã€‚

### â“ å¦‚ä½•è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼Ÿ
> åœ¨å‰ç«¯"è¯·æ±‚å¤´"æ ‡ç­¾é¡µæ·»åŠ å³å¯ï¼Œæ”¯æŒå˜é‡æ›¿æ¢ã€‚

### â“ å¦‚ä½•åˆ‡æ¢ä¸ºç›´æ¥è¯·æ±‚ï¼ˆä¸èµ°ä»£ç†ï¼‰ï¼Ÿ
> åªéœ€å…³é—­åç«¯æœåŠ¡æˆ–ä¿®æ”¹ `/api/mode` è¿”å›å†…å®¹ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨åˆ‡æ¢ä¸ºç›´è¿æ¨¡å¼ã€‚

### â“ æ•°æ®å®‰å…¨å—ï¼Ÿ
> æ‰€æœ‰æ•°æ®ä»…å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ï¼ˆlocalStorageï¼‰ï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚ä¼ä¸šå†…ç½‘ã€æ•æ„Ÿç¯å¢ƒä½¿ç”¨æ— å¿§ã€‚

### â“ æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ
> æ”¯æŒWindowsã€Linuxã€MacOSã€ARMæ¶æ„ï¼ŒåŒ…æ‹¬å›½äº§ä¿¡åˆ›å¹³å°ã€‚ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œã€‚åŒæ—¶å®Œç¾æ”¯æŒIPv4å’ŒIPv6ç½‘ç»œåè®®ã€‚

### â“ æ”¯æŒå“ªäº›é€šä¿¡åè®®ï¼Ÿ
> é™¤äº†ä¼ ç»Ÿçš„HTTP/HTTPSè¯·æ±‚ï¼Œè¿˜åŸç”Ÿæ”¯æŒWebSocketï¼ˆåŒå‘é€šä¿¡ï¼‰å’ŒSSEï¼ˆServer-Sent Eventsï¼Œå•å‘å®æ—¶æ¨é€ï¼‰ï¼Œæ»¡è¶³å„ç§å®æ—¶é€šä¿¡éœ€æ±‚ã€‚

### â“ MockServerå’ŒEchoServeræœ‰å•¥åŒºåˆ«ï¼Ÿ
> EchoServerè¿”å›çš„å†…å®¹ç›¸å¯¹å›ºå®šï¼ŒMockServerå®Œå…¨æ”¯æŒè‡ªå®šä¹‰,æ”¯æŒæ ¹æ®æ¡ä»¶åŠ¨æ€æ„å»ºå“åº”å†…å®¹ã€‚

### â“ EchoServeræœ‰ä»€ä¹ˆç”¨ï¼Ÿ
> EchoServeræä¾›å®Œæ•´çš„è¯·æ±‚å›æ˜¾å’Œå“åº”æ§åˆ¶åŠŸèƒ½ï¼Œé€‚åˆæ¥å£è°ƒè¯•ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€ç½‘ç»œå»¶è¿Ÿæ¨¡æ‹Ÿç­‰åœºæ™¯ã€‚æ”¯æŒå¤šç§å“åº”æ ¼å¼å’Œæµå¼é€šä¿¡ã€‚

### â“ å¦‚ä½•å…³é—­EchoServerï¼Ÿ
> å¯åŠ¨æ—¶æ·»åŠ  `--echo-server=false` å‚æ•°å³å¯å…³é—­EchoServerè°ƒè¯•æœåŠ¡ã€‚

### â“ å¦‚ä½•å¼€å¯é™æ€æ–‡ä»¶æœåŠ¡å™¨æ¨¡å¼ï¼Ÿ
> ä½¿ç”¨ `--webroot` å‚æ•°å¯åŠ¨é™æ€æ–‡ä»¶æœåŠ¡å™¨æ¨¡å¼ã€‚æ‰€æœ‰APIæ¥å£å°†å¤±æ•ˆï¼Œå˜æˆä¸€ä¸ªçº¯é™æ€æ–‡ä»¶æœåŠ¡å™¨ã€‚

### â“ é™æ€æ–‡ä»¶æœåŠ¡å™¨æ”¯æŒå“ªäº›æ–‡ä»¶ç±»å‹ï¼Ÿ
> æ”¯æŒæ‰€æœ‰å¸¸è§æ–‡ä»¶ç±»å‹ï¼šHTMLã€CSSã€JSã€å›¾ç‰‡ï¼ˆPNG/JPG/GIF/SVGï¼‰ã€éŸ³é¢‘ï¼ˆMP3/WAVï¼‰ã€è§†é¢‘ï¼ˆMP4ï¼‰ã€å­—ä½“æ–‡ä»¶ã€PDFã€å‹ç¼©åŒ…ç­‰ã€‚ä¼šè‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„MIMEç±»å‹ã€‚

---

## ğŸ¤ è´¡çŒ®ä¸åé¦ˆ

- ğŸ› æ¬¢è¿æäº¤ issue æˆ– PRï¼Œå®Œå–„åŠŸèƒ½å’Œæ–‡æ¡£ã€‚
- ğŸ’¡ å¦‚æœ‰å»ºè®®æˆ– bugï¼Œæ¬¢è¿åé¦ˆï¼

---

## ğŸ“„ License

MIT

---

å¦‚éœ€è¿›ä¸€æ­¥å®šåˆ¶æˆ–æœ‰ç–‘é—®ï¼Œæ¬¢è¿è”ç³»ä½œè€…ã€‚

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªStarï¼**

**ğŸ’¬ æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨GitHubä¸Šè®¨è®ºï¼**

---

*è®©APIè°ƒè¯•å˜å¾—ç®€å•è€Œä¼˜é›…* âœ¨
